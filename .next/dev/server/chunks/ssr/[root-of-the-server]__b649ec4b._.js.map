{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 28, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/lacos/Downloads/pacelink/lib/supabaseBrowser.ts"],"sourcesContent":["import { createBrowserClient } from '@supabase/ssr';\r\n\r\nexport function createClient() {\r\n  return createBrowserClient(\r\n    process.env.NEXT_PUBLIC_SUPABASE_URL!,\r\n    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AAAA;;AAEO,SAAS;IACd,OAAO,IAAA,iMAAmB;AAI5B"}},
    {"offset": {"line": 42, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/lacos/Downloads/pacelink/app/students/%5Bid%5D/page.tsx"],"sourcesContent":["'use client';\n\nimport React, { useEffect, useMemo, useState } from 'react';\nimport { useParams, useRouter } from 'next/navigation';\nimport { createClient } from '../../../lib/supabaseBrowser';\n\ntype StudentRow = {\n  id: string;\n  trainer_id: string;\n  name: string;\n  email: string | null;\n  p1k_sec_per_km: number | null;\n  public_slug: string | null;\n  created_at: string | null;\n};\n\ntype WeekRow = {\n  id: string;\n  student_id: string;\n  trainer_id: string;\n  week_start: string; // YYYY-MM-DD\n  week_end: string | null;\n  label: string | null;\n};\n\ntype WorkoutRow = {\n  id: string;\n  student_id: string;\n  trainer_id: string;\n  week_id: string | null;\n  status: 'draft' | 'ready' | 'archived';\n  template_type: string | null;\n  title: string | null;\n  total_km: number | null;\n  planned_date: string | null;\n  planned_day: number | null;\n  created_at: string | null;\n  share_slug: string | null;\n  locked_at: string | null;\n  closed_reason: string | null;\n};\n\ntype ExecutionRow = {\n  id: string;\n  workout_id: string;\n  status: string;\n  started_at: string | null;\n  last_event_at: string | null;\n  completed_at: string | null;\n  performed_at: string | null;\n  total_elapsed_ms: number | null;\n  rpe: number | null;\n  comment: string | null;\n  actual_total_km: number | null;\n};\n\nfunction startOfWeekMonday(date: Date) {\n  const d = new Date(date);\n  const day = d.getDay(); // 0..6 (Sun..Sat)\n  const diff = (day === 0 ? -6 : 1) - day; // move to Monday\n  d.setDate(d.getDate() + diff);\n  d.setHours(0, 0, 0, 0);\n  return d;\n}\n\nfunction toISODate(d: Date) {\n  const yyyy = d.getFullYear();\n  const mm = String(d.getMonth() + 1).padStart(2, '0');\n  const dd = String(d.getDate()).padStart(2, '0');\n  return `${yyyy}-${mm}-${dd}`;\n}\n\nfunction addDays(d: Date, days: number) {\n  const x = new Date(d);\n  x.setDate(x.getDate() + days);\n  return x;\n}\n\nfunction formatWeekLabel(weekStartISO: string) {\n  // \"Semana dd/mm - dd/mm\"\n  const [y, m, d] = weekStartISO.split('-');\n  const start = new Date(Number(y), Number(m) - 1, Number(d));\n  const end = addDays(start, 6);\n  const dd1 = String(start.getDate()).padStart(2, '0');\n  const mm1 = String(start.getMonth() + 1).padStart(2, '0');\n  const dd2 = String(end.getDate()).padStart(2, '0');\n  const mm2 = String(end.getMonth() + 1).padStart(2, '0');\n  return `Semana ${dd1}/${mm1} – ${dd2}/${mm2}`;\n}\n\nfunction formatPace(secPerKm: number | null) {\n  if (!secPerKm || !Number.isFinite(secPerKm)) return '—';\n  const mm = Math.floor(secPerKm / 60);\n  const ss = Math.round(secPerKm % 60);\n  return `${mm}:${String(ss).padStart(2, '0')}/km`;\n}\n\nfunction formatKm(n: number | null) {\n  if (n == null || !Number.isFinite(n)) return '—';\n  return `${String(n).replace('.', ',')} km`;\n}\n\nfunction formatDateBR(dateStr?: string | null) {\n  if (!dateStr) return '';\n  const parts = dateStr.split('-');\n  if (parts.length !== 3) return dateStr;\n  const [y, m, d] = parts;\n  return `${d}/${m}/${y}`;\n}\n\nexport default function StudentTrainerPage() {\n  const router = useRouter();\n  const params = useParams<{ id: string }>();\n  const studentId = params.id;\n\n  const supabase = useMemo(() => createClient(), []);\n  const [banner, setBanner] = useState<string | null>(null);\n\n  const [student, setStudent] = useState<StudentRow | null>(null);\n  const [weeks, setWeeks] = useState<WeekRow[]>([]);\n  const [selectedWeekId, setSelectedWeekId] = useState<string | null>(null);\n\n  const [workouts, setWorkouts] = useState<WorkoutRow[]>([]);\n  const [latestExecByWorkout, setLatestExecByWorkout] = useState<Record<string, ExecutionRow | null>>({});\n\n  const studentSlug = student?.public_slug ?? 'aluno';\n\n  async function loadStudent() {\n    setBanner(null);\n    const { data, error } = await supabase\n      .from('students')\n      .select('id,trainer_id,name,email,p1k_sec_per_km,public_slug,created_at')\n      .eq('id', studentId)\n      .maybeSingle();\n\n    if (error) {\n      setBanner(error.message);\n      return;\n    }\n\n    if (!data) {\n      setBanner('Aluno não encontrado.');\n      return;\n    }\n\n    setStudent(data as any);\n  }\n\n  async function ensureUpcomingWeeks(s: StudentRow) {\n    // garante que as próximas semanas existam na tabela training_weeks\n    setBanner(null);\n\n    const start = startOfWeekMonday(new Date());\n    const starts = Array.from({ length: 6 }).map((_, i) => toISODate(addDays(start, i * 7)));\n\n    // upsert: (student_id, week_start) unique\n    const payload = starts.map((ws) => ({\n      student_id: s.id,\n      trainer_id: s.trainer_id,\n      week_start: ws,\n      week_end: toISODate(addDays(new Date(ws), 6)),\n      label: formatWeekLabel(ws),\n    }));\n\n    // Table real: training_weeks\n    const { error: upErr } = await supabase.from('training_weeks').upsert(payload, {\n      onConflict: 'student_id,week_start',\n    });\n\n    if (upErr) {\n      setBanner(upErr.message);\n      return;\n    }\n\n    // reload list\n    const { data, error } = await supabase\n      .from('training_weeks')\n      .select('id,student_id,trainer_id,week_start,week_end,label')\n      .eq('student_id', s.id)\n      .order('week_start', { ascending: true });\n\n    if (error) {\n      setBanner(error.message);\n      return;\n    }\n\n    const list = (data || []) as WeekRow[];\n    setWeeks(list);\n\n    const currentStartISO = toISODate(startOfWeekMonday(new Date()));\n    const current = list.find((w) => w.week_start === currentStartISO) || list[0] || null;\n    setSelectedWeekId(current?.id || null);\n  }\n\n  async function loadWorkoutsForWeek(weekId: string | null) {\n    if (!weekId) {\n      setWorkouts([]);\n      setLatestExecByWorkout({});\n      return;\n    }\n\n    setBanner(null);\n\n    // Treinos da semana selecionada\n    const { data: ws, error } = await supabase\n      .from('workouts')\n      .select(\n        'id, student_id, trainer_id, status, template_type, title, total_km, created_at, planned_date, planned_day, share_slug, week_id, locked_at, closed_reason'\n      )\n      .eq('student_id', studentId)\n      .eq('week_id', weekId)\n      .order('planned_day', { ascending: true, nullsFirst: false })\n      .order('created_at', { ascending: false })\n      .limit(200);\n\n    if (error) {\n      setBanner(error.message);\n      return;\n    }\n\n    const list = (ws || []) as WorkoutRow[];\n    setWorkouts(list);\n\n    if (list.length === 0) {\n      setLatestExecByWorkout({});\n      return;\n    }\n\n    // pega última execução por workout (view v_workouts_last_execution existe no seu schema)\n    const ids = list.map((w) => w.id);\n    const { data: ex } = await supabase\n      .from('v_workouts_last_execution')\n      .select(\n        'workout_id, execution_id, status, started_at, last_event_at, completed_at, performed_at, total_elapsed_ms, rpe, comment, actual_total_km'\n      )\n      .in('workout_id', ids);\n\n    const map: Record<string, ExecutionRow | null> = {};\n    (ex || []).forEach((row: any) => {\n      map[row.workout_id] = {\n        id: row.execution_id,\n        workout_id: row.workout_id,\n        status: row.status,\n        started_at: row.started_at,\n        last_event_at: row.last_event_at,\n        completed_at: row.completed_at,\n        performed_at: row.performed_at,\n        total_elapsed_ms: row.total_elapsed_ms,\n        rpe: row.rpe,\n        comment: row.comment,\n        actual_total_km: row.actual_total_km,\n      } as any;\n    });\n\n    setLatestExecByWorkout(map);\n  }\n\n  function makeRandomSlug(len = 12) {\n    const chars = 'abcdefghijklmnopqrstuvwxyz0123456789';\n    let out = '';\n    const arr = new Uint32Array(len);\n    // crypto.getRandomValues existe no browser moderno (incl. mobile)\n    crypto.getRandomValues(arr);\n    for (let i = 0; i < len; i++) out += chars[arr[i] % chars.length];\n    return out;\n  }\n\n  async function ensureShareSlug(workoutId: string) {\n    // 1) tenta ler share_slug atual\n    const { data: cur, error: curErr } = await supabase.from('workouts').select('id, share_slug, status').eq('id', workoutId).maybeSingle();\n    if (curErr) throw curErr;\n    const currentSlug = (cur as any)?.share_slug as string | null;\n    if (currentSlug) return currentSlug;\n\n    // 2) gera slug e tenta gravar (lida com colisão UNIQUE)\n    for (let i = 0; i < 8; i++) {\n      const slug = makeRandomSlug(12);\n      const { data: upd, error: updErr } = await supabase\n        .from('workouts')\n        .update({ status: 'ready', share_slug: slug })\n        .eq('id', workoutId)\n        .is('share_slug', null)\n        .select('id, share_slug')\n        .maybeSingle();\n\n      if (!updErr) {\n        const got = (upd as any)?.share_slug as string | null;\n        if (got) return got;\n      } else {\n        // 23505 = unique_violation (slug já existe)\n        if ((updErr as any).code !== '23505') throw updErr;\n      }\n    }\n\n    throw new Error('Não foi possível gerar o link (share_slug).');\n  }\n\n  async function shareWorkoutLink(workoutId: string) {\n    setBanner(null);\n\n    try {\n      const slug = await ensureShareSlug(workoutId);\n      const url = `${window.location.origin}/w/${studentSlug}/${slug}`;\n\n      // Preferência: abrir menu nativo de compartilhamento (Android/iOS)\n      if (navigator.share) {\n        await navigator.share({\n          title: 'Treino do aluno',\n          text: `Treino programado para ${student?.name ?? 'aluno'}`,\n          url,\n        });\n        setBanner('Abrindo opções de compartilhamento...');\n      } else if (navigator.clipboard) {\n        await navigator.clipboard.writeText(url);\n        setBanner('Link copiado para a área de transferência.');\n      } else {\n        // fallback final (WhatsApp)\n        window.open(`https://wa.me/?text=${encodeURIComponent(url)}`, '_blank');\n        setBanner('Abrindo WhatsApp para compartilhar...');\n      }\n\n      // atualiza local\n      setWorkouts((prev) => prev.map((w) => (w.id === workoutId ? ({ ...w, status: 'ready', share_slug: slug } as any) : w)));\n    } catch (e: any) {\n      setBanner(e?.message || 'Não foi possível gerar/compartilhar o link.');\n    }\n  }\n\n  function openWorkoutAsAluno(workout: WorkoutRow) {\n    const slug = workout.share_slug;\n    if (!slug) {\n      setBanner('Treino sem link (share_slug). Use \"Gerar/Compartilhar\".');\n      return;\n    }\n    const url = `/w/${studentSlug}/${slug}`;\n    // abre em nova aba/janela para o treinador não perder a tela\n    if (typeof window !== 'undefined') {\n      window.open(url, '_blank');\n    } else {\n      router.push(url);\n    }\n  }\n\n  // Load student\n  useEffect(() => {\n    if (!studentId) return;\n    loadStudent();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [studentId]);\n\n  // Ensure weeks after student loaded\n  useEffect(() => {\n    if (!student) return;\n    ensureUpcomingWeeks(student);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [student?.id]);\n\n  // Load workouts when week changes\n  useEffect(() => {\n    loadWorkoutsForWeek(selectedWeekId);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [selectedWeekId]);\n\n  const selectedWeek = weeks.find((w) => w.id === selectedWeekId) || null;\n\n  const header = (\n    <div className=\"flex items-start justify-between gap-3\">\n      <div className=\"min-w-0\">\n        <div className=\"text-sm text-slate-600 dark:text-slate-300\">Aluno</div>\n        <div className=\"text-xl font-semibold truncate\">{student?.name ?? '—'}</div>\n        <div className=\"text-sm text-slate-600 dark:text-slate-300 mt-1\">\n          Ritmo P1k: <span className=\"font-semibold\">{formatPace(student?.p1k_sec_per_km ?? null)}</span>\n          {student?.email ? <> · {student.email}</> : null}\n        </div>\n        <div className=\"text-xs text-slate-500 dark:text-slate-400 mt-1\">\n          Links do aluno: <span className=\"font-mono\">/aluno</span> (login) ·{' '}\n          <span className=\"font-mono\">/w/{studentSlug}/&lt;treino&gt;</span>\n        </div>\n      </div>\n\n      <div className=\"shrink-0 flex flex-col items-end gap-2\">\n        <button\n          className=\"px-3 py-2 rounded-lg bg-slate-900 text-white text-sm font-semibold disabled:opacity-50\"\n          disabled={!selectedWeekId}\n          onClick={() => router.push(`/students/${studentId}/workouts/new?weekId=${selectedWeekId}`)}\n        >\n          + Programar treino\n        </button>\n        <button className=\"text-sm underline text-slate-600 dark:text-slate-300\" onClick={() => router.push('/students')}>\n          Voltar\n        </button>\n      </div>\n    </div>\n  );\n\n  return (\n    <main className=\"min-h-screen bg-slate-50 dark:bg-slate-950 p-4\">\n      <div className=\"mx-auto max-w-3xl space-y-4\">\n        <div className=\"rounded-2xl bg-white dark:bg-surface-dark shadow p-4\">{header}</div>\n\n        {banner && (\n          <div className=\"rounded-xl bg-red-50 dark:bg-red-900/20 p-4 text-sm text-red-700 dark:text-red-300\">{banner}</div>\n        )}\n\n        {/* Calendário de semanas */}\n        <div className=\"rounded-2xl bg-white dark:bg-surface-dark shadow p-4\">\n          <div className=\"flex items-center justify-between mb-3\">\n            <h2 className=\"font-semibold\">Planejamento por semana</h2>\n            <div className=\"text-xs text-slate-500 dark:text-slate-400\">\n              {selectedWeek ? selectedWeek.label : '—'}\n            </div>\n          </div>\n\n          <div className=\"flex flex-wrap gap-2\">\n            {weeks.map((w) => (\n              <button\n                key={w.id}\n                className={`px-3 py-2 rounded-full text-sm font-semibold border ${\n                  selectedWeekId === w.id\n                    ? 'bg-primary text-slate-900 border-primary'\n                    : 'bg-slate-100 dark:bg-slate-800 border-slate-200 dark:border-slate-700 text-slate-900 dark:text-slate-100'\n                }`}\n                onClick={() => setSelectedWeekId(w.id)}\n              >\n                {w.label ?? formatWeekLabel(w.week_start)}\n              </button>\n            ))}\n          </div>\n        </div>\n\n        {/* Lista de treinos da semana */}\n        <div className=\"rounded-2xl bg-white dark:bg-surface-dark shadow p-4\">\n          <div className=\"flex items-start justify-between gap-3 mb-3\">\n            <div>\n              <h2 className=\"font-semibold\">Treinos da semana</h2>\n              <div className=\"text-xs text-slate-500 dark:text-slate-400 mt-1\">\n                Programados: <span className=\"font-semibold\">{workouts.length}</span>\n                {' '}· Disponíveis: <span className=\"font-semibold\">{workouts.filter((x) => x.status === 'ready').length}</span>\n                {' '}· Rascunhos: <span className=\"font-semibold\">{workouts.filter((x) => x.status === 'draft').length}</span>\n              </div>\n            </div>\n            <div className=\"text-xs text-slate-500 dark:text-slate-400\">Mostrando até 200</div>\n          </div>\n\n          {workouts.length === 0 ? (\n            <div className=\"text-sm text-slate-600 dark:text-slate-300\">Nenhum treino programado para esta semana ainda.</div>\n          ) : (\n            <div className=\"space-y-3\">\n              {workouts.map((w) => {\n                const latestExec = latestExecByWorkout[w.id];\n                const locked = !!w.locked_at || (latestExec && (latestExec.status === 'in_progress' || latestExec.status === 'completed'));\n                const planned = w.planned_date ? `Planejado: ${formatDateBR(w.planned_date)}` : w.planned_day ? `Dia: ${w.planned_day}` : '';\n                const template = w.template_type ? w.template_type : '—';\n                const progress =\n                  latestExec?.status === 'completed'\n                    ? 'Concluído'\n                    : latestExec?.status === 'in_progress'\n                    ? 'Em andamento'\n                    : w.status === 'ready'\n                    ? 'Disponível'\n                    : w.status === 'draft'\n                    ? 'Rascunho'\n                    : 'Arquivado';\n\n                return (\n                  <div key={w.id} className=\"rounded-2xl border border-slate-200 dark:border-slate-800 p-4\">\n                    <div className=\"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-3\">\n                      <div className=\"min-w-0\">\n                        <div className=\"flex items-center gap-2 flex-wrap\">\n                          <div className=\"text-sm font-semibold truncate\">{w.title || 'Treino'}</div>\n                          <div className=\"text-xs text-slate-500 dark:text-slate-400\">·</div>\n                          <div className=\"text-xs text-slate-500 dark:text-slate-400\">{template}</div>\n                          {w.total_km != null ? (\n                            <>\n                              <div className=\"text-xs text-slate-500 dark:text-slate-400\">·</div>\n                              <div className=\"text-xs text-slate-500 dark:text-slate-400\">{formatKm(w.total_km)}</div>\n                            </>\n                          ) : null}\n                        </div>\n\n                        <div className=\"text-xs text-slate-500 dark:text-slate-400 mt-1\">\n                          {planned ? `${planned} · ` : ''}\n                          Status: <span className=\"font-semibold\">{progress}</span>\n                          {locked ? ' · Edição bloqueada após início' : ''}\n                        </div>\n                      </div>\n\n                      <div className=\"w-full sm:w-auto flex flex-col sm:flex-row sm:flex-wrap gap-2 sm:justify-end\">\n                        <button\n                          className=\"w-full sm:w-auto px-3 py-2 rounded-lg bg-slate-100 dark:bg-slate-800 text-sm font-semibold whitespace-nowrap disabled:opacity-50\"\n                          disabled={locked}\n                          onClick={() => router.push(`/workouts/${w.id}/edit`)}\n                        >\n                          Editar\n                        </button>\n\n                        <button\n                          className=\"w-full sm:w-auto px-3 py-2 rounded-lg bg-primary text-slate-900 text-sm font-semibold whitespace-nowrap disabled:opacity-50\"\n                          disabled={w.status === 'archived'}\n                          onClick={() => shareWorkoutLink(w.id)}\n                        >\n                          Gerar/Compartilhar\n                        </button>\n\n                        <button\n                          className=\"w-full sm:w-auto px-3 py-2 rounded-lg bg-slate-900 text-white text-sm font-semibold whitespace-nowrap disabled:opacity-50\"\n                          disabled={!w.share_slug}\n                          onClick={() => openWorkoutAsAluno(w)}\n                        >\n                          Ver como aluno\n                        </button>\n                      </div>\n                    </div>\n\n                    {w.share_slug ? (\n                      <div className=\"text-xs text-slate-500 dark:text-slate-400 mt-2\">\n                        Link: <span className=\"font-mono\">/w/{studentSlug}/{w.share_slug}</span>\n                      </div>\n                    ) : (\n                      <div className=\"text-xs text-slate-500 dark:text-slate-400 mt-2\">Link ainda não gerado (share_slug vazio).</div>\n                    )}\n\n                    {w.closed_reason ? (\n                      <div className=\"text-xs text-slate-500 dark:text-slate-400 mt-1\">Encerrado: {w.closed_reason}</div>\n                    ) : null}\n                  </div>\n                );\n              })}\n            </div>\n          )}\n        </div>\n      </div>\n    </main>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}