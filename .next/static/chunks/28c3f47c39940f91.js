(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,18566,(e,t,a)=>{t.exports=e.r(76562)},46852,e=>{"use strict";var t=e.i(43476);let a=({title:e="PaceLink",showBack:a=!1,onBack:s,rightSlot:l,action:r,className:d=""})=>(0,t.jsx)("div",{className:`w-full bg-[#d1d1d1] ${d}`,children:(0,t.jsxs)("div",{className:"mx-auto max-w-2xl flex items-center justify-between px-4 py-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 min-w-0",children:[a?(0,t.jsx)("button",{type:"button",onClick:s,"aria-label":"Voltar",className:"text-white/90 hover:text-white",children:(0,t.jsx)("span",{className:"text-2xl leading-none",children:"‹"})}):null,(0,t.jsx)("div",{className:"text-white text-xl font-semibold truncate",children:e})]}),(0,t.jsx)("div",{className:"flex items-center gap-2",children:l??r??null})]})});e.s(["Topbar",0,a,"default",0,a])},86193,e=>{"use strict";var t=e.i(43476),a=e.i(71645),s=e.i(18566),l=e.i(27972),r=e.i(46852);let d={easy_run:"Rodagem",progressive:"Progressivo",alternated:"Alternado"};function n(e){if(!e)return"";let t=e.split("-");if(3!==t.length)return e;let[a,s,l]=t;return`${l}/${s}/${a}`}function i(){let e=(0,s.useRouter)(),i=(0,a.useMemo)(()=>(0,l.createClient)(),[]),[o,c]=(0,a.useState)(!0),[m,u]=(0,a.useState)(null),[x,p]=(0,a.useState)([]),[h,f]=(0,a.useState)({}),[g,_]=(0,a.useState)(null);(0,a.useEffect)(()=>{let t=!1;return async function(){c(!0),_(null);let{data:{user:a},error:s}=await i.auth.getUser();if(t)return;if(s){_(s.message),c(!1);return}if(!a){let t=window.location.pathname+window.location.search;e.replace(`/login?next=${encodeURIComponent(t)}`);return}let{data:l,error:r}=await i.from("students").select("id,name,p1k_pace,public_slug").or(`auth_user_id.eq.${a.id},user_id.eq.${a.id}`).maybeSingle();if(t)return;if(r){_(r.message),c(!1);return}if(!l){let{data:t}=await i.from("profiles").select("id").eq("id",a.id).maybeSingle();return t?.id?e.replace("/students"):(_("Seu usuário não está vinculado a um aluno ou treinador."),c(!1))}u(l);let{data:d,error:n}=await i.from("workouts").select("id,title,status,template_type,planned_date,planned_day,total_km,share_slug").eq("student_id",l.id).eq("status","ready").order("planned_date",{ascending:!0,nullsFirst:!1}).order("created_at",{ascending:!1});if(t)return;if(n){_(n.message),c(!1);return}let o=d??[];p(o);let m=o.map(e=>e.id);if(m.length>0){let{data:e}=await i.from("executions").select("id,workout_id,status,performed_at,completed_at,last_event_at,started_at,actual_total_km,rpe").in("workout_id",m),t={};(e??[]).forEach(e=>{let a=e.workout_id;t[a]||(t[a]=[]),t[a].push(e)});let a={};Object.keys(t).forEach(e=>{var s;let l,r;a[e]=(s=t[e],l=e=>e?new Date(e).getTime():0,r=e=>Math.max(l(e.last_event_at),l(e.completed_at),l(e.started_at),l(e.performed_at)),s.slice().sort((e,t)=>r(t)-r(e))[0])}),f(a)}else f({});c(!1)}(),()=>{t=!0}},[e,i]);let b=(0,a.useMemo)(()=>{let e=new Map;return x.forEach(t=>{let a=function(e){if(!e)return"Sem data";let[t,a,s]=e.split("-").map(e=>parseInt(e,10));if(!t||!a||!s)return"Sem data";let l=new Date(t,a-1,s),r=l.getDay();l.setDate(l.getDate()-(r+6)%7);let d=l.getFullYear(),n=String(l.getMonth()+1).padStart(2,"0"),i=String(l.getDate()).padStart(2,"0");return`${d}-${n}-${i}`}(t.planned_date),s=e.get(a)??[];s.push(t),e.set(a,s)}),Array.from(e.keys()).sort((e,t)=>"Sem data"===e?1:"Sem data"===t?-1:e.localeCompare(t)).map(t=>({key:t,label:function(e){if("Sem data"===e)return"Treinos sem data planejada";let[t,a,s]=e.split("-");return`Semana de ${s}/${a}/${t}`}(t),workouts:(e.get(t)??[]).slice().sort((e,t)=>(e.planned_date??"").localeCompare(t.planned_date??""))}))},[x]);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.default,{title:"Área do Aluno"}),(0,t.jsx)("main",{className:"flex-1 p-4",children:o?(0,t.jsx)("div",{className:"text-sm text-slate-600 dark:text-slate-300",children:"Carregando…"}):g?(0,t.jsx)("div",{className:"rounded-xl bg-red-50 dark:bg-red-900/20 p-4 text-sm text-red-700 dark:text-red-300",children:g}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"mb-4 rounded-2xl bg-white dark:bg-surface-dark p-4 shadow",children:[(0,t.jsx)("div",{className:"text-sm text-slate-600 dark:text-slate-300",children:"Aluno"}),(0,t.jsx)("div",{className:"text-xl font-semibold",children:m?.name}),(0,t.jsxs)("div",{className:"mt-1 text-sm text-slate-600 dark:text-slate-300",children:[(0,t.jsx)("span",{className:"font-medium",children:"Ritmo P1k:"})," ",m?.p1k_pace??"—"]}),(0,t.jsx)("div",{className:"mt-3",children:(0,t.jsx)("button",{className:"text-sm underline text-slate-600 dark:text-slate-300",onClick:async()=>{await i.auth.signOut(),e.replace("/login")},children:"Sair"})})]}),0===b.length?(0,t.jsx)("div",{className:"text-sm text-slate-600 dark:text-slate-300",children:"Nenhum treino disponível."}):(0,t.jsx)("div",{className:"space-y-4",children:b.map(a=>(0,t.jsxs)("section",{className:"rounded-2xl bg-white dark:bg-surface-dark p-4 shadow",children:[(0,t.jsx)("h3",{className:"font-semibold mb-3",children:a.label}),(0,t.jsx)("div",{className:"space-y-3",children:a.workouts.map(a=>{let s=h[a.id],l=s?.status==="completed",r=m?.public_slug&&a.share_slug?`/w/${m.public_slug}/${a.share_slug}`:null;return(0,t.jsxs)("div",{className:"rounded-xl border border-slate-200 dark:border-slate-700 p-3 flex items-start justify-between gap-3",children:[(0,t.jsxs)("div",{className:"min-w-0",children:[(0,t.jsxs)("div",{className:"text-sm text-slate-600 dark:text-slate-300",children:[a.planned_date?n(a.planned_date):"Sem data"," ·"," ",d[a.template_type]??a.template_type," · ",a.total_km," km"]}),(0,t.jsx)("div",{className:"font-medium truncate",children:a.title||d[a.template_type]||"Treino"}),l?(0,t.jsxs)("div",{className:"mt-1 text-xs text-green-700 dark:text-green-300",children:["Feito",s?.performed_at?` em ${n(s.performed_at)}`:"",s?.rpe?` \xb7 RPE ${s.rpe}`:""]}):s?.status==="in_progress"?(0,t.jsx)("div",{className:"mt-1 text-xs text-amber-700 dark:text-amber-300",children:"Em andamento"}):(0,t.jsx)("div",{className:"mt-1 text-xs text-slate-500 dark:text-slate-400",children:"Pendente"})]}),(0,t.jsx)("div",{className:"shrink-0",children:(0,t.jsx)("button",{className:"px-3 py-2 rounded-lg bg-primary text-slate-900 font-semibold text-sm disabled:opacity-50",disabled:!r,onClick:()=>r&&e.push(r),children:"Abrir"})})]},a.id)})})]},a.key))})]})})]})}e.s(["default",()=>i])}]);