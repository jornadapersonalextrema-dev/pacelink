(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,18566,(e,t,r)=>{t.exports=e.r(76562)},46852,e=>{"use strict";var t=e.i(43476);let r=({title:e="PaceLink",showBack:r=!1,onBack:a,rightSlot:s,action:i,className:l=""})=>(0,t.jsx)("div",{className:`w-full bg-[#d1d1d1] ${l}`,children:(0,t.jsxs)("div",{className:"mx-auto max-w-2xl flex items-center justify-between px-4 py-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 min-w-0",children:[r?(0,t.jsx)("button",{type:"button",onClick:a,"aria-label":"Voltar",className:"text-white/90 hover:text-white",children:(0,t.jsx)("span",{className:"text-2xl leading-none",children:"‹"})}):null,(0,t.jsx)("div",{className:"text-white text-xl font-semibold truncate",children:e})]}),(0,t.jsx)("div",{className:"flex items-center gap-2",children:s??i??null})]})});e.s(["Topbar",0,r,"default",0,r])},48978,e=>{"use strict";var t=e.i(43476);let r=({children:e,variant:r="primary",size:a="lg",icon:s,fullWidth:i=!0,className:l="",...n})=>(0,t.jsxs)("button",{className:`flex items-center justify-center gap-2 rounded-full font-bold transition-all active:scale-[0.98] ${{primary:"bg-primary text-background-dark shadow-lg shadow-primary/25 hover:bg-[#25c464]",secondary:"bg-white dark:bg-surface-dark border border-slate-200 dark:border-white/10 text-slate-900 dark:text-white",ghost:"bg-transparent text-slate-600 dark:text-slate-400 hover:bg-black/5 dark:hover:bg-white/5",danger:"bg-red-500 text-white shadow-lg shadow-red-500/20"}[r]} ${{sm:"h-9 px-4 text-xs",md:"h-11 px-6 text-sm",lg:"h-14 px-8 text-lg",xl:"h-16 px-10 text-xl"}[a]} ${i?"w-full":""} ${l}`,...n,children:[s&&(0,t.jsx)("span",{className:"material-symbols-outlined",children:s}),e]});e.s(["Button",0,r,"default",0,r])},44848,e=>{"use strict";var t=e.i(43476),r=e.i(71645),a=e.i(18566),s=e.i(27972),i=e.i(46852),l=e.i(48978);function n(){return Math.random().toString(36).slice(2)+Date.now().toString(36)}function d(e){let t=Number(String(e).replace(",","."));return Number.isFinite(t)?t:0}function o(e,t){if(!e||e<=0)return"—";let r=e;"leve"===t&&(r=1.2*e),"forte"===t&&(r=.9*e);let a=Math.floor(r/60),s=Math.round(r%60);return`${a}:${String(s).padStart(2,"0")}/km`}function c(){let e=(0,r.useMemo)(()=>(0,s.createClient)(),[]),c=(0,a.useRouter)(),u=(0,a.useParams)(),m=(0,a.useSearchParams)(),x=String(u?.id||""),h=m?.get("weekId"),[b,p]=(0,r.useState)(!0),[g,f]=(0,r.useState)(!1),[w,v]=(0,r.useState)(null),[j,k]=(0,r.useState)(null),[N,y]=(0,r.useState)(null),[S,_]=(0,r.useState)("Treino"),[C,$]=(0,r.useState)(!0),[M,T]=(0,r.useState)(1),[K,P]=(0,r.useState)(!0),[D,A]=(0,r.useState)(1),[B,E]=(0,r.useState)([{id:n(),distanceKm:"1",intensity:"moderado",paceStr:"",note:""},{id:n(),distanceKm:"1",intensity:"forte",paceStr:"",note:""}]),R=(0,r.useMemo)(()=>Math.round(10*(((C?M:0)||0)+((K?D:0)||0)+B.reduce((e,t)=>e+d(t.distanceKm),0)))/10,[C,M,K,D,B]);function q(e,t){E(r=>r.map(r=>r.id===e?{...r,...t}:r))}async function O(){if(j){f(!0),v(null);try{let{data:t}=await e.auth.getSession(),r=t?.session?.user?.id;if(!r)throw Error("Você precisa estar logado como treinador.");let a={...{trainer_id:r,student_id:j.id,status:"draft",template_type:"run",title:S?.trim()||null,include_warmup:C,warmup_km:C?M:0,include_cooldown:K,cooldown_km:K?D:0,total_km:R,share_slug:null,blocks:B.map(e=>({distance_km:d(e.distanceKm),intensity:e.intensity,pace:e.paceStr||null,note:e.note||null}))}};h&&(a.week_id=h);let{data:s,error:i}=await e.from("workouts").insert(a).select("id").single();if(i)throw i;c.push(`/workouts/${s.id}/edit`)}catch(e){v(e?.message||"Erro ao salvar")}finally{f(!1)}}}return(0,r.useEffect)(()=>{let t=!0;return async function(){p(!0),v(null);try{let{data:r,error:a}=await e.from("students").select("id,name,public_slug,email,p1k_sec_per_km").eq("id",x).maybeSingle();if(a)throw a;if(!r)throw Error("Aluno não encontrado");if(!t)return;if(k(r),h){let{data:r,error:a}=await e.from("weeks").select("id,trainer_id,week_start,week_end,label").eq("id",h).maybeSingle();if(a)throw a;if(!t)return;y(r)}r?.p1k_sec_per_km&&E(e=>e.map(e=>({...e,paceStr:e.paceStr||o(r.p1k_sec_per_km,e.intensity)})))}catch(e){if(!t)return;v(e?.message||"Erro ao carregar")}finally{if(!t)return;p(!1)}}(),()=>{t=!1}},[e,x,h]),b?(0,t.jsxs)("div",{className:"min-h-screen bg-gradient-to-b from-background-dark to-black text-white",children:[(0,t.jsx)(i.default,{title:"Novo treino"}),(0,t.jsx)("div",{className:"mx-auto max-w-4xl p-6",children:"Carregando…"})]}):(0,t.jsxs)("div",{className:"min-h-screen bg-gradient-to-b from-background-dark to-black text-white",children:[(0,t.jsx)(i.default,{title:"Novo treino"}),(0,t.jsxs)("div",{className:"mx-auto max-w-4xl p-6 space-y-6",children:[(0,t.jsxs)("div",{className:"rounded-3xl bg-surface-dark/70 border border-white/10 p-6",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-sm text-white/60",children:"Novo treino"}),(0,t.jsx)("div",{className:"text-2xl font-extrabold",children:j?.name}),(0,t.jsxs)("div",{className:"text-sm text-white/60 mt-1",children:["Ritmo P1k: ",function(e){if(!e||e<=0)return"—";let t=Math.floor(e/60),r=Math.round(e%60);return`${t}:${String(r).padStart(2,"0")}/km`}(j?.p1k_sec_per_km||null)]}),N?.week_start&&N?.week_end&&(0,t.jsxs)("div",{className:"mt-2 text-sm text-white/70",children:["Semana: ",(0,t.jsx)("span",{className:"font-semibold",children:N.label||function(e,t){try{let r=new Date(e+"T00:00:00"),a=new Date(t+"T00:00:00"),s=e=>`${String(e.getDate()).padStart(2,"0")}/${String(e.getMonth()+1).padStart(2,"0")}`;return`${s(r)} – ${s(a)}`}catch{return`${e} – ${t}`}}(N.week_start,N.week_end)})]})]}),(0,t.jsx)("div",{className:"flex gap-2",children:(0,t.jsx)("button",{onClick:()=>c.back(),className:"px-4 h-10 rounded-full bg-white/5 hover:bg-white/10 border border-white/10",children:"Voltar"})})]}),w&&(0,t.jsx)("div",{className:"mt-4 rounded-2xl bg-red-500/15 border border-red-500/30 p-4 text-red-200",children:w})]}),(0,t.jsxs)("div",{className:"rounded-3xl bg-surface-dark/70 border border-white/10 p-6 space-y-4",children:[(0,t.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-sm text-white/60 mb-1",children:"Título"}),(0,t.jsx)("input",{value:S,onChange:e=>_(e.target.value),className:"w-full h-12 rounded-2xl bg-black/30 border border-white/10 px-4 outline-none focus:border-primary"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-sm text-white/60 mb-1",children:"Total estimado"}),(0,t.jsxs)("div",{className:"h-12 rounded-2xl bg-black/30 border border-white/10 px-4 flex items-center font-bold",children:[R," km"]})]})]}),(0,t.jsxs)("div",{className:"flex flex-col gap-3 md:flex-row md:items-center md:gap-6",children:[(0,t.jsxs)("label",{className:"flex items-center gap-2",children:[(0,t.jsx)("input",{type:"checkbox",checked:C,onChange:e=>$(e.target.checked)}),(0,t.jsx)("span",{className:"text-white/80",children:"Aquecimento"})]}),(0,t.jsx)("input",{disabled:!C,value:M,onChange:e=>T(Number(e.target.value)),type:"number",step:"0.5",min:"0",className:"w-28 h-10 rounded-2xl bg-black/30 border border-white/10 px-3 outline-none disabled:opacity-40"}),(0,t.jsx)("span",{className:"text-white/60",children:"km"}),(0,t.jsxs)("label",{className:"flex items-center gap-2 md:ml-6",children:[(0,t.jsx)("input",{type:"checkbox",checked:K,onChange:e=>P(e.target.checked)}),(0,t.jsx)("span",{className:"text-white/80",children:"Desaquecimento"})]}),(0,t.jsx)("input",{disabled:!K,value:D,onChange:e=>A(Number(e.target.value)),type:"number",step:"0.5",min:"0",className:"w-28 h-10 rounded-2xl bg-black/30 border border-white/10 px-3 outline-none disabled:opacity-40"}),(0,t.jsx)("span",{className:"text-white/60",children:"km"})]})]}),(0,t.jsxs)("div",{className:"rounded-3xl bg-surface-dark/70 border border-white/10 p-6 space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("div",{className:"text-lg font-extrabold",children:"Blocos"}),(0,t.jsx)("button",{onClick:function(){let e=j?.p1k_sec_per_km||null,t="moderado";E(r=>[...r,{id:n(),distanceKm:"1",intensity:t,paceStr:o(e,t),note:""}])},className:"px-4 h-10 rounded-full bg-white/5 hover:bg-white/10 border border-white/10",children:"+ Adicionar bloco"})]}),(0,t.jsx)("div",{className:"space-y-3",children:B.map((e,r)=>(0,t.jsxs)("div",{className:"rounded-2xl bg-black/25 border border-white/10 p-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"font-bold",children:["Bloco ",r+1]}),B.length>1&&(0,t.jsx)("button",{onClick:()=>{var t;return t=e.id,void E(e=>e.filter(e=>e.id!==t))},className:"text-sm text-red-200 hover:text-red-100",children:"Remover"})]}),(0,t.jsxs)("div",{className:"mt-3 grid gap-3 md:grid-cols-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-sm text-white/60 mb-1",children:"Distância (km)"}),(0,t.jsx)("input",{value:e.distanceKm,onChange:t=>q(e.id,{distanceKm:t.target.value}),className:"w-full h-10 rounded-2xl bg-black/30 border border-white/10 px-3 outline-none focus:border-primary"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-sm text-white/60 mb-1",children:"Intensidade"}),(0,t.jsxs)("select",{value:e.intensity,onChange:t=>q(e.id,{intensity:t.target.value,paceStr:o(j?.p1k_sec_per_km||null,t.target.value)}),className:"w-full h-10 rounded-2xl bg-black/30 border border-white/10 px-3 outline-none focus:border-primary",children:[(0,t.jsx)("option",{value:"leve",children:"Leve"}),(0,t.jsx)("option",{value:"moderado",children:"Moderado"}),(0,t.jsx)("option",{value:"forte",children:"Forte"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-sm text-white/60 mb-1",children:"Pace sugerido"}),(0,t.jsx)("input",{value:e.paceStr,onChange:t=>q(e.id,{paceStr:t.target.value}),className:"w-full h-10 rounded-2xl bg-black/30 border border-white/10 px-3 outline-none focus:border-primary"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-sm text-white/60 mb-1",children:"Obs"}),(0,t.jsx)("input",{value:e.note,onChange:t=>q(e.id,{note:t.target.value}),className:"w-full h-10 rounded-2xl bg-black/30 border border-white/10 px-3 outline-none focus:border-primary"})]})]})]},e.id))}),(0,t.jsx)("div",{className:"pt-2",children:(0,t.jsx)(l.default,{onClick:O,disabled:g,children:g?"Salvando…":"Criar treino"})})]})]})]})}e.s(["default",()=>c])}]);