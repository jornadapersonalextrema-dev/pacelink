(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,80334,e=>{"use strict";var t=e.i(43476);e.s(["Card",0,({children:e,className:a="",onClick:r})=>(0,t.jsx)("div",{onClick:r,className:`bg-white dark:bg-surface-dark rounded-2xl border border-slate-200 dark:border-white/5 p-4 shadow-sm transition-all ${r?"cursor-pointer hover:border-primary/50 active:scale-[0.99]":""} ${a}`,children:e})])},18566,(e,t,a)=>{t.exports=e.r(76562)},48978,e=>{"use strict";var t=e.i(43476);e.s(["Button",0,({children:e,variant:a="primary",size:r="lg",icon:s,fullWidth:i=!0,className:l="",...n})=>(0,t.jsxs)("button",{className:`flex items-center justify-center gap-2 rounded-full font-bold transition-all active:scale-[0.98] ${{primary:"bg-primary text-background-dark shadow-lg shadow-primary/25 hover:bg-[#25c464]",secondary:"bg-white dark:bg-surface-dark border border-slate-200 dark:border-white/10 text-slate-900 dark:text-white",ghost:"bg-transparent text-slate-600 dark:text-slate-400 hover:bg-black/5 dark:hover:bg-white/5",danger:"bg-red-500 text-white shadow-lg shadow-red-500/20"}[a]} ${{sm:"h-9 px-4 text-xs",md:"h-11 px-6 text-sm",lg:"h-14 px-8 text-lg",xl:"h-16 px-10 text-xl"}[r]} ${i?"w-full":""} ${l}`,...n,children:[s&&(0,t.jsx)("span",{className:"material-symbols-outlined",children:s}),e]})])},46852,e=>{"use strict";var t=e.i(43476),a=e.i(18566);e.s(["Topbar",0,({title:e,showBack:r=!1,rightAction:s})=>{let i=(0,a.useRouter)();return(0,t.jsxs)("header",{className:"sticky top-0 z-50 flex items-center justify-between px-4 py-4 bg-white/80 dark:bg-background-dark/80 backdrop-blur-md border-b border-black/5 dark:border-white/5 h-16",children:[(0,t.jsx)("div",{className:"flex items-center min-w-[40px]",children:r&&(0,t.jsx)("button",{onClick:()=>i.back(),className:"p-2 -ml-2 rounded-full hover:bg-black/5 dark:hover:bg-white/10 text-slate-900 dark:text-white transition-colors",children:(0,t.jsx)("span",{className:"material-symbols-outlined",children:"arrow_back_ios_new"})})}),(0,t.jsx)("h1",{className:"text-lg font-bold tracking-tight text-center flex-1 truncate px-2",children:e}),(0,t.jsx)("div",{className:"flex items-center justify-end min-w-[40px]",children:s})]})}])},44848,e=>{"use strict";var t=e.i(43476),a=e.i(71645),r=e.i(18566),s=e.i(27972),i=e.i(46852),l=e.i(48978),n=e.i(80334),o=e.i(84192),d=e.i(3136),c=e.i(20558);function m(e,t,a){return Number.isFinite(e)?Math.min(Math.max(e,t),a):t}function u(e){return Number((e??"").toString().replace(",","."))}function x(){let e=(0,r.useRouter)(),x=(0,r.useParams)(),h=x?.id??"",p=(0,a.useMemo)(()=>(0,s.createClient)(),[]),[g,b]=(0,a.useState)(!0),[f,v]=(0,a.useState)(null),[k,w]=(0,a.useState)(null),[j,N]=(0,a.useState)(""),[y,_]=(0,a.useState)("rodagem"),[C,S]=(0,a.useState)(!0),[T,E]=(0,a.useState)(2),[I,A]=(0,a.useState)(!0),[$,K]=(0,a.useState)(1),[M,R]=(0,a.useState)(5),[B,D]=(0,a.useState)("leve"),[q,P]=(0,a.useState)([{distanceKm:2,intensity:"leve"},{distanceKm:2,intensity:"moderado"},{distanceKm:1,intensity:"forte"}]),[L,F]=(0,a.useState)(6),[O,U]=(0,a.useState)({distanceKm:1,intensity:"forte"}),[z,H]=(0,a.useState)({distanceKm:1,intensity:"leve"}),[W,G]=(0,a.useState)(""),[J,Q]=(0,a.useState)(!1),[V,X]=(0,a.useState)(null);async function Y(){let{data:t}=await p.auth.getUser();if(!t?.user)throw e.push("/login"),Error("Sessão expirada. Faça login novamente.");return t.user}(0,a.useEffect)(()=>{let e=!0;async function t(){try{b(!0),w(null);let t=await Y(),{data:a,error:r}=await p.from("students").select("id, trainer_id, name, email, p1k_sec_per_km").eq("id",h).eq("trainer_id",t.id).limit(1);if(r)throw r;let s=a?.[0]??null;if(!s)throw Error("Aluno não encontrado (ou você não tem permissão para acessá-lo).");e&&v({id:s.id,trainer_id:s.trainer_id,name:s.name,email:s.email??null,p1k_sec_per_km:s.p1k_sec_per_km??null})}catch(t){console.error("Erro ao carregar aluno:",t),e&&w(t?.message||"Erro ao carregar aluno.")}finally{e&&b(!1)}}return h&&t(),()=>{e=!1}},[h]);let Z=(0,a.useMemo)(()=>{let e=C?m(T,.5,30):0,t=I?m($,.5,30):0,a=[],r=e+t;if("rodagem"===y){let e=m(M,.5,60);a=[{distance_km:e,intensity:B,label:"Bloco principal"}],r+=e}if("progressivo"===y){let e=q.map(e=>({distance_km:m(e.distanceKm,.5,60),intensity:e.intensity}));a=e,r+=e.reduce((e,t)=>e+Number(t.distance_km),0)}if("alternado"===y){let e=m(L,1,40),t=m(O.distanceKm,.1,10),s=m(z.distanceKm,.1,10);a=Array.from({length:e}).flatMap(()=>[{distance_km:t,intensity:O.intensity,role:"trabalho"},{distance_km:s,intensity:z.intensity,role:"recuperacao"}]),r+=e*(t+s)}return{warmup_km:e,cooldown_km:t,total_km:r,blocks:a}},[C,T,I,$,y,M,B,q,L,O,z]);async function ee(e){try{Q(!0),w(null);let t=await Y();if(!f)throw Error("Aluno não carregado.");let a={student_id:f.id,trainer_id:t.id,status:e,template_type:y,include_warmup:C,warmup_km:Z.warmup_km,include_cooldown:I,cooldown_km:Z.cooldown_km,template_params:{title:j?.trim()||null,notes:W?.trim()||null},blocks:Z.blocks,total_km:Z.total_km};if(V){let{data:e,error:t}=await p.from("workouts").update(a).eq("id",V).select("id, share_slug").maybeSingle();if(t)throw t;if(!e)throw Error("Não foi possível atualizar o treino (verifique permissões/RLS).");return e}{let{data:e,error:t}=await p.from("workouts").insert(a).select("id, share_slug").single();if(t)throw t;return X(e.id),e}}catch(e){throw console.error("Erro ao salvar treino:",e),w(e?.message||"Erro ao salvar treino."),e}finally{Q(!1)}}async function et(){await ee("draft")}async function ea(){let e=await ee("published"),t=`${window.location.origin}/w/${e.share_slug}`;try{if(navigator.share)return void await navigator.share({title:"PaceLink",text:"Treino",url:t})}catch(e){}try{await navigator.clipboard.writeText(t),alert("Link copiado! Cole no WhatsApp para enviar ao aluno.")}catch(e){window.prompt("Copie o link do treino:",t)}}let er=e=>`px-4 py-2 rounded-full text-sm font-semibold transition ${e?"bg-primary text-slate-900 shadow-lg shadow-primary/20":"bg-white/10 text-white/70 hover:bg-white/15"}`;return(0,t.jsxs)("div",{className:"flex-1 flex flex-col bg-background-light dark:bg-background-dark",children:[(0,t.jsx)(i.Topbar,{title:"Criar Treino",backHref:`/students/${h}`}),(0,t.jsxs)("main",{className:"flex-1 p-4 space-y-4",children:[k&&(0,t.jsx)("div",{className:"rounded-xl bg-red-900/40 border border-red-700/40 p-3 text-red-200 text-sm",children:k}),(0,t.jsxs)(n.Card,{children:[(0,t.jsx)("div",{className:"text-xs tracking-wider text-white/60",children:"ALUNO"}),(0,t.jsx)("div",{className:"text-lg font-bold",children:g?"Carregando...":f?.name||"—"}),(0,t.jsxs)("div",{className:"text-sm text-white/70",children:["Ritmo P1K: ",function(e){if(!e||e<=0)return"—";let t=Math.floor(e/60);return`${t}:${String(e%60).padStart(2,"0")}`}(f?.p1k_sec_per_km)," min/km"]})]}),(0,t.jsxs)(n.Card,{children:[(0,t.jsx)("div",{className:"text-base font-bold",children:"Título do treino"}),(0,t.jsx)(o.Input,{value:j,onChange:e=>N(e.target.value),placeholder:"Ex.: Rodagem leve"}),(0,t.jsxs)("div",{className:"text-sm text-white/60 mt-2",children:["Distância total estimada: ",Z.total_km.toFixed(1)," km"]})]}),(0,t.jsxs)(n.Card,{children:[(0,t.jsx)("div",{className:"text-base font-bold",children:"Tipo de Treino"}),(0,t.jsxs)("div",{className:"mt-3 flex gap-2 flex-wrap",children:[(0,t.jsx)("button",{onClick:()=>_("rodagem"),className:er("rodagem"===y),children:"Rodagem"}),(0,t.jsx)("button",{onClick:()=>_("progressivo"),className:er("progressivo"===y),children:"Progressivo"}),(0,t.jsx)("button",{onClick:()=>_("alternado"),className:er("alternado"===y),children:"Alternado"})]})]}),(0,t.jsxs)(n.Card,{children:[(0,t.jsx)("div",{className:"text-base font-bold",children:"Estrutura"}),(0,t.jsxs)("div",{className:"mt-4 flex items-center justify-between",children:[(0,t.jsx)("div",{className:"font-semibold",children:"Aquecimento"}),(0,t.jsx)(d.Toggle,{checked:C,onChange:S})]}),C&&(0,t.jsxs)("div",{className:"mt-3 grid grid-cols-3 gap-2 items-end",children:[(0,t.jsxs)("div",{className:"col-span-2",children:[(0,t.jsx)("div",{className:"text-xs text-white/60",children:"DISTÂNCIA"}),(0,t.jsx)(o.Input,{type:"text",inputMode:"decimal",value:String(T),onChange:e=>E(u(e.target.value))})]}),(0,t.jsx)("div",{className:"text-sm text-white/70 pb-2",children:"km"})]}),(0,t.jsxs)("div",{className:"mt-6 flex items-center justify-between",children:[(0,t.jsx)("div",{className:"font-semibold",children:"Desaquecimento"}),(0,t.jsx)(d.Toggle,{checked:I,onChange:A})]}),I&&(0,t.jsxs)("div",{className:"mt-3 grid grid-cols-3 gap-2 items-end",children:[(0,t.jsxs)("div",{className:"col-span-2",children:[(0,t.jsx)("div",{className:"text-xs text-white/60",children:"DISTÂNCIA"}),(0,t.jsx)(o.Input,{type:"text",inputMode:"decimal",value:String($),onChange:e=>K(u(e.target.value))})]}),(0,t.jsx)("div",{className:"text-sm text-white/70 pb-2",children:"km"})]})]}),"rodagem"===y&&(0,t.jsxs)(n.Card,{children:[(0,t.jsx)("div",{className:"text-base font-bold",children:"Bloco principal"}),(0,t.jsxs)("div",{className:"mt-3 grid grid-cols-3 gap-2 items-end",children:[(0,t.jsxs)("div",{className:"col-span-2",children:[(0,t.jsx)("div",{className:"text-xs text-white/60",children:"DISTÂNCIA"}),(0,t.jsx)(o.Input,{type:"text",inputMode:"decimal",value:String(M),onChange:e=>R(u(e.target.value))})]}),(0,t.jsx)("div",{className:"text-sm text-white/70 pb-2",children:"km"})]}),(0,t.jsx)("div",{className:"mt-4 text-xs text-white/60",children:"INTENSIDADE"}),(0,t.jsxs)("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[(0,t.jsx)("button",{onClick:()=>D("leve"),className:er("leve"===B)+" flex-1 min-w-[96px] justify-center",children:"Leve"}),(0,t.jsx)("button",{onClick:()=>D("moderado"),className:er("moderado"===B)+" flex-1 min-w-[96px] justify-center",children:"Moderado"}),(0,t.jsx)("button",{onClick:()=>D("forte"),className:er("forte"===B)+" flex-1 min-w-[96px] justify-center",children:"Forte"})]})]}),(0,t.jsxs)(n.Card,{children:[(0,t.jsx)("div",{className:"text-base font-bold",children:"Observações (opcional)"}),(0,t.jsx)(o.Input,{value:W,onChange:e=>G(e.target.value),placeholder:"Ex.: Terreno plano, foco em controlar respiração"})]})]}),(0,t.jsxs)("div",{className:"p-4 grid grid-cols-2 gap-3 bg-background-dark/70 backdrop-blur sticky bottom-0",children:[(0,t.jsx)(l.Button,{variant:"secondary",onClick:et,disabled:J,children:"Salvar Rascunho"}),(0,t.jsxs)(l.Button,{onClick:ea,disabled:J,children:[(0,t.jsx)(c.Icon,{name:"share",className:"mr-2"}),"Compartilhar"]})]})]})}e.s(["default",()=>x],44848)}]);