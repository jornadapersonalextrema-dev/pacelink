module.exports=[9270,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.AppRouterContext},36313,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.HooksClientContext},18341,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.ServerInsertedHtml},18622,(a,b,c)=>{b.exports=a.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},20635,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/action-async-storage.external.js",()=>require("next/dist/server/app-render/action-async-storage.external.js"))},32319,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},42602,(a,b,c)=>{"use strict";b.exports=a.r(18622)},87924,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactJsxRuntime},72131,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].React},19314,a=>{"use strict";var b=a.i(87924);a.s(["Card",0,({children:a,className:c="",onClick:d})=>(0,b.jsx)("div",{onClick:d,className:`bg-white dark:bg-surface-dark rounded-2xl border border-slate-200 dark:border-white/5 p-4 shadow-sm transition-all ${d?"cursor-pointer hover:border-primary/50 active:scale-[0.99]":""} ${c}`,children:a})])},34136,a=>{"use strict";var b=a.i(87924);a.s(["Button",0,({children:a,variant:c="primary",size:d="lg",icon:e,fullWidth:f=!0,className:g="",...h})=>(0,b.jsxs)("button",{className:`flex items-center justify-center gap-2 rounded-full font-bold transition-all active:scale-[0.98] ${{primary:"bg-primary text-background-dark shadow-lg shadow-primary/25 hover:bg-[#25c464]",secondary:"bg-white dark:bg-surface-dark border border-slate-200 dark:border-white/10 text-slate-900 dark:text-white",ghost:"bg-transparent text-slate-600 dark:text-slate-400 hover:bg-black/5 dark:hover:bg-white/5",danger:"bg-red-500 text-white shadow-lg shadow-red-500/20"}[c]} ${{sm:"h-9 px-4 text-xs",md:"h-11 px-6 text-sm",lg:"h-14 px-8 text-lg",xl:"h-16 px-10 text-xl"}[d]} ${f?"w-full":""} ${g}`,...h,children:[e&&(0,b.jsx)("span",{className:"material-symbols-outlined",children:e}),a]})])},81361,a=>{"use strict";var b=a.i(87924),c=a.i(50944);a.s(["Topbar",0,({title:a,showBack:d=!1,rightAction:e})=>{let f=(0,c.useRouter)();return(0,b.jsxs)("header",{className:"sticky top-0 z-50 flex items-center justify-between px-4 py-4 bg-white/80 dark:bg-background-dark/80 backdrop-blur-md border-b border-black/5 dark:border-white/5 h-16",children:[(0,b.jsx)("div",{className:"flex items-center min-w-[40px]",children:d&&(0,b.jsx)("button",{onClick:()=>f.back(),className:"p-2 -ml-2 rounded-full hover:bg-black/5 dark:hover:bg-white/10 text-slate-900 dark:text-white transition-colors",children:(0,b.jsx)("span",{className:"material-symbols-outlined",children:"arrow_back_ios_new"})})}),(0,b.jsx)("h1",{className:"text-lg font-bold tracking-tight text-center flex-1 truncate px-2",children:a}),(0,b.jsx)("div",{className:"flex items-center justify-end min-w-[40px]",children:e})]})}])},50181,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(19818),f=a.i(81361),g=a.i(34136),h=a.i(19314),i=a.i(19851),j=a.i(62259),k=a.i(75166);function l(a,b,c){return Number.isFinite(a)?Math.min(Math.max(a,b),c):b}function m(a){return Number((a??"").toString().replace(",","."))}function n(){let a=(0,d.useRouter)(),n=(0,d.useParams)(),o=n?.id??"",p=(0,c.useMemo)(()=>(0,e.createClient)(),[]),[q,r]=(0,c.useState)(!0),[s,t]=(0,c.useState)(null),[u,v]=(0,c.useState)(null),[w,x]=(0,c.useState)(""),[y,z]=(0,c.useState)("rodagem"),[A,B]=(0,c.useState)(!0),[C,D]=(0,c.useState)(2),[E,F]=(0,c.useState)(!0),[G,H]=(0,c.useState)(1),[I,J]=(0,c.useState)(5),[K,L]=(0,c.useState)("leve"),[M,N]=(0,c.useState)([{distanceKm:2,intensity:"leve"},{distanceKm:2,intensity:"moderado"},{distanceKm:1,intensity:"forte"}]),[O,P]=(0,c.useState)(6),[Q,R]=(0,c.useState)({distanceKm:1,intensity:"forte"}),[S,T]=(0,c.useState)({distanceKm:1,intensity:"leve"}),[U,V]=(0,c.useState)(""),[W,X]=(0,c.useState)(!1),[Y,Z]=(0,c.useState)(null);async function $(){let{data:b}=await p.auth.getUser();if(!b?.user)throw a.push("/login"),Error("Sessão expirada. Faça login novamente.");return b.user}(0,c.useEffect)(()=>{let a=!0;async function b(){try{r(!0),v(null);let b=await $(),{data:c,error:d}=await p.from("students").select("id, trainer_id, name, email, p1k_sec_per_km").eq("id",o).eq("trainer_id",b.id).limit(1);if(d)throw d;let e=c?.[0]??null;if(!e)throw Error("Aluno não encontrado (ou você não tem permissão para acessá-lo).");a&&t({id:e.id,trainer_id:e.trainer_id,name:e.name,email:e.email??null,p1k_sec_per_km:e.p1k_sec_per_km??null})}catch(b){console.error("Erro ao carregar aluno:",b),a&&v(b?.message||"Erro ao carregar aluno.")}finally{a&&r(!1)}}return o&&b(),()=>{a=!1}},[o]);let _=(0,c.useMemo)(()=>{let a=A?l(C,.5,30):0,b=E?l(G,.5,30):0,c=[],d=a+b;if("rodagem"===y){let a=l(I,.5,60);c=[{distance_km:a,intensity:K,label:"Bloco principal"}],d+=a}if("progressivo"===y){let a=M.map(a=>({distance_km:l(a.distanceKm,.5,60),intensity:a.intensity}));c=a,d+=a.reduce((a,b)=>a+Number(b.distance_km),0)}if("alternado"===y){let a=l(O,1,40),b=l(Q.distanceKm,.1,10),e=l(S.distanceKm,.1,10);c=Array.from({length:a}).flatMap(()=>[{distance_km:b,intensity:Q.intensity,role:"trabalho"},{distance_km:e,intensity:S.intensity,role:"recuperacao"}]),d+=a*(b+e)}return{warmup_km:a,cooldown_km:b,total_km:d,blocks:c}},[A,C,E,G,y,I,K,M,O,Q,S]);async function aa(a){try{X(!0),v(null);let b=await $();if(!s)throw Error("Aluno não carregado.");let c={student_id:s.id,trainer_id:b.id,status:a,template_type:y,include_warmup:A,warmup_km:_.warmup_km,include_cooldown:E,cooldown_km:_.cooldown_km,template_params:{title:w?.trim()||null,notes:U?.trim()||null},blocks:_.blocks,total_km:_.total_km};if(Y){let{data:a,error:b}=await p.from("workouts").update(c).eq("id",Y).select("id, share_slug").maybeSingle();if(b)throw b;if(!a)throw Error("Não foi possível atualizar o treino (verifique permissões/RLS).");return a}{let{data:a,error:b}=await p.from("workouts").insert(c).select("id, share_slug").single();if(b)throw b;return Z(a.id),a}}catch(a){throw console.error("Erro ao salvar treino:",a),v(a?.message||"Erro ao salvar treino."),a}finally{X(!1)}}async function ab(){await aa("draft")}async function ac(){let a=await aa("published"),b=`${window.location.origin}/w/${a.share_slug}`;try{if(navigator.share)return void await navigator.share({title:"PaceLink",text:"Treino",url:b})}catch(a){}try{await navigator.clipboard.writeText(b),alert("Link copiado! Cole no WhatsApp para enviar ao aluno.")}catch(a){window.prompt("Copie o link do treino:",b)}}let ad=a=>`px-4 py-2 rounded-full text-sm font-semibold transition ${a?"bg-primary text-slate-900 shadow-lg shadow-primary/20":"bg-white/10 text-white/70 hover:bg-white/15"}`;return(0,b.jsxs)("div",{className:"flex-1 flex flex-col bg-background-light dark:bg-background-dark",children:[(0,b.jsx)(f.Topbar,{title:"Criar Treino",backHref:`/students/${o}`}),(0,b.jsxs)("main",{className:"flex-1 p-4 space-y-4",children:[u&&(0,b.jsx)("div",{className:"rounded-xl bg-red-900/40 border border-red-700/40 p-3 text-red-200 text-sm",children:u}),(0,b.jsxs)(h.Card,{children:[(0,b.jsx)("div",{className:"text-xs tracking-wider text-white/60",children:"ALUNO"}),(0,b.jsx)("div",{className:"text-lg font-bold",children:q?"Carregando...":s?.name||"—"}),(0,b.jsxs)("div",{className:"text-sm text-white/70",children:["Ritmo P1K: ",function(a){if(!a||a<=0)return"—";let b=Math.floor(a/60);return`${b}:${String(a%60).padStart(2,"0")}`}(s?.p1k_sec_per_km)," min/km"]})]}),(0,b.jsxs)(h.Card,{children:[(0,b.jsx)("div",{className:"text-base font-bold",children:"Título do treino"}),(0,b.jsx)(i.Input,{value:w,onChange:a=>x(a.target.value),placeholder:"Ex.: Rodagem leve"}),(0,b.jsxs)("div",{className:"text-sm text-white/60 mt-2",children:["Distância total estimada: ",_.total_km.toFixed(1)," km"]})]}),(0,b.jsxs)(h.Card,{children:[(0,b.jsx)("div",{className:"text-base font-bold",children:"Tipo de Treino"}),(0,b.jsxs)("div",{className:"mt-3 flex gap-2 flex-wrap",children:[(0,b.jsx)("button",{onClick:()=>z("rodagem"),className:ad("rodagem"===y),children:"Rodagem"}),(0,b.jsx)("button",{onClick:()=>z("progressivo"),className:ad("progressivo"===y),children:"Progressivo"}),(0,b.jsx)("button",{onClick:()=>z("alternado"),className:ad("alternado"===y),children:"Alternado"})]})]}),(0,b.jsxs)(h.Card,{children:[(0,b.jsx)("div",{className:"text-base font-bold",children:"Estrutura"}),(0,b.jsxs)("div",{className:"mt-4 flex items-center justify-between",children:[(0,b.jsx)("div",{className:"font-semibold",children:"Aquecimento"}),(0,b.jsx)(j.Toggle,{checked:A,onChange:B})]}),A&&(0,b.jsxs)("div",{className:"mt-3 grid grid-cols-3 gap-2 items-end",children:[(0,b.jsxs)("div",{className:"col-span-2",children:[(0,b.jsx)("div",{className:"text-xs text-white/60",children:"DISTÂNCIA"}),(0,b.jsx)(i.Input,{type:"text",inputMode:"decimal",value:String(C),onChange:a=>D(m(a.target.value))})]}),(0,b.jsx)("div",{className:"text-sm text-white/70 pb-2",children:"km"})]}),(0,b.jsxs)("div",{className:"mt-6 flex items-center justify-between",children:[(0,b.jsx)("div",{className:"font-semibold",children:"Desaquecimento"}),(0,b.jsx)(j.Toggle,{checked:E,onChange:F})]}),E&&(0,b.jsxs)("div",{className:"mt-3 grid grid-cols-3 gap-2 items-end",children:[(0,b.jsxs)("div",{className:"col-span-2",children:[(0,b.jsx)("div",{className:"text-xs text-white/60",children:"DISTÂNCIA"}),(0,b.jsx)(i.Input,{type:"text",inputMode:"decimal",value:String(G),onChange:a=>H(m(a.target.value))})]}),(0,b.jsx)("div",{className:"text-sm text-white/70 pb-2",children:"km"})]})]}),"rodagem"===y&&(0,b.jsxs)(h.Card,{children:[(0,b.jsx)("div",{className:"text-base font-bold",children:"Bloco principal"}),(0,b.jsxs)("div",{className:"mt-3 grid grid-cols-3 gap-2 items-end",children:[(0,b.jsxs)("div",{className:"col-span-2",children:[(0,b.jsx)("div",{className:"text-xs text-white/60",children:"DISTÂNCIA"}),(0,b.jsx)(i.Input,{type:"text",inputMode:"decimal",value:String(I),onChange:a=>J(m(a.target.value))})]}),(0,b.jsx)("div",{className:"text-sm text-white/70 pb-2",children:"km"})]}),(0,b.jsx)("div",{className:"mt-4 text-xs text-white/60",children:"INTENSIDADE"}),(0,b.jsxs)("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[(0,b.jsx)("button",{onClick:()=>L("leve"),className:ad("leve"===K)+" flex-1 min-w-[96px] justify-center",children:"Leve"}),(0,b.jsx)("button",{onClick:()=>L("moderado"),className:ad("moderado"===K)+" flex-1 min-w-[96px] justify-center",children:"Moderado"}),(0,b.jsx)("button",{onClick:()=>L("forte"),className:ad("forte"===K)+" flex-1 min-w-[96px] justify-center",children:"Forte"})]})]}),(0,b.jsxs)(h.Card,{children:[(0,b.jsx)("div",{className:"text-base font-bold",children:"Observações (opcional)"}),(0,b.jsx)(i.Input,{value:U,onChange:a=>V(a.target.value),placeholder:"Ex.: Terreno plano, foco em controlar respiração"})]})]}),(0,b.jsxs)("div",{className:"p-4 grid grid-cols-2 gap-3 bg-background-dark/70 backdrop-blur sticky bottom-0",children:[(0,b.jsx)(g.Button,{variant:"secondary",onClick:ab,disabled:W,children:"Salvar Rascunho"}),(0,b.jsxs)(g.Button,{onClick:ac,disabled:W,children:[(0,b.jsx)(k.Icon,{name:"share",className:"mr-2"}),"Compartilhar"]})]})]})}a.s(["default",()=>n],50181)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__083235dd._.js.map