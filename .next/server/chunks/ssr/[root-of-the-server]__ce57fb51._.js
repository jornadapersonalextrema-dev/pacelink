module.exports=[9270,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.AppRouterContext},36313,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.HooksClientContext},18341,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.ServerInsertedHtml},18622,(a,b,c)=>{b.exports=a.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},20635,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/action-async-storage.external.js",()=>require("next/dist/server/app-render/action-async-storage.external.js"))},32319,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},42602,(a,b,c)=>{"use strict";b.exports=a.r(18622)},87924,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactJsxRuntime},72131,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].React},81361,a=>{"use strict";var b=a.i(87924);let c=({title:a="PaceLink",showBack:c=!1,onBack:d,rightSlot:e,action:f,className:g=""})=>(0,b.jsx)("div",{className:`w-full bg-[#d1d1d1] ${g}`,children:(0,b.jsxs)("div",{className:"mx-auto max-w-2xl flex items-center justify-between px-4 py-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 min-w-0",children:[c?(0,b.jsx)("button",{type:"button",onClick:d,"aria-label":"Voltar",className:"text-white/90 hover:text-white",children:(0,b.jsx)("span",{className:"text-2xl leading-none",children:"‹"})}):null,(0,b.jsx)("div",{className:"text-white text-xl font-semibold truncate",children:a})]}),(0,b.jsx)("div",{className:"flex items-center gap-2",children:e??f??null})]})});a.s(["Topbar",0,c,"default",0,c])},4019,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(19818),f=a.i(81361);let g={easy_run:"Rodagem",progressive:"Progressivo",alternated:"Alternado"};function h(a){if(!a)return"";let b=a.split("-");if(3!==b.length)return a;let[c,d,e]=b;return`${e}/${d}/${c}`}function i(){let a=(0,d.useRouter)(),i=(0,c.useMemo)(()=>(0,e.createClient)(),[]),[j,k]=(0,c.useState)(!0),[l,m]=(0,c.useState)(null),[n,o]=(0,c.useState)([]),[p,q]=(0,c.useState)({}),[r,s]=(0,c.useState)(null);(0,c.useEffect)(()=>{let b=!1;return async function(){k(!0),s(null);let{data:{user:c},error:d}=await i.auth.getUser();if(b)return;if(d){s(d.message),k(!1);return}if(!c){let b=window.location.pathname+window.location.search;a.replace(`/login?next=${encodeURIComponent(b)}`);return}let{data:e,error:f}=await i.from("students").select("id,name,p1k_pace,public_slug").or(`auth_user_id.eq.${c.id},user_id.eq.${c.id}`).maybeSingle();if(b)return;if(f){s(f.message),k(!1);return}if(!e){let{data:b}=await i.from("profiles").select("id").eq("id",c.id).maybeSingle();return b?.id?a.replace("/students"):(s("Seu usuário não está vinculado a um aluno ou treinador."),k(!1))}m(e);let{data:g,error:h}=await i.from("workouts").select("id,title,status,template_type,planned_date,planned_day,total_km,share_slug").eq("student_id",e.id).eq("status","ready").order("planned_date",{ascending:!0,nullsFirst:!1}).order("created_at",{ascending:!1});if(b)return;if(h){s(h.message),k(!1);return}let j=g??[];o(j);let l=j.map(a=>a.id);if(l.length>0){let{data:a}=await i.from("executions").select("id,workout_id,status,performed_at,completed_at,last_event_at,started_at,actual_total_km,rpe").in("workout_id",l),b={};(a??[]).forEach(a=>{let c=a.workout_id;b[c]||(b[c]=[]),b[c].push(a)});let c={};Object.keys(b).forEach(a=>{var d;let e,f;c[a]=(d=b[a],e=a=>a?new Date(a).getTime():0,f=a=>Math.max(e(a.last_event_at),e(a.completed_at),e(a.started_at),e(a.performed_at)),d.slice().sort((a,b)=>f(b)-f(a))[0])}),q(c)}else q({});k(!1)}(),()=>{b=!0}},[a,i]);let t=(0,c.useMemo)(()=>{let a=new Map;return n.forEach(b=>{let c=function(a){if(!a)return"Sem data";let[b,c,d]=a.split("-").map(a=>parseInt(a,10));if(!b||!c||!d)return"Sem data";let e=new Date(b,c-1,d),f=e.getDay();e.setDate(e.getDate()-(f+6)%7);let g=e.getFullYear(),h=String(e.getMonth()+1).padStart(2,"0"),i=String(e.getDate()).padStart(2,"0");return`${g}-${h}-${i}`}(b.planned_date),d=a.get(c)??[];d.push(b),a.set(c,d)}),Array.from(a.keys()).sort((a,b)=>"Sem data"===a?1:"Sem data"===b?-1:a.localeCompare(b)).map(b=>({key:b,label:function(a){if("Sem data"===a)return"Treinos sem data planejada";let[b,c,d]=a.split("-");return`Semana de ${d}/${c}/${b}`}(b),workouts:(a.get(b)??[]).slice().sort((a,b)=>(a.planned_date??"").localeCompare(b.planned_date??""))}))},[n]);return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(f.default,{title:"Área do Aluno"}),(0,b.jsx)("main",{className:"flex-1 p-4",children:j?(0,b.jsx)("div",{className:"text-sm text-slate-600 dark:text-slate-300",children:"Carregando…"}):r?(0,b.jsx)("div",{className:"rounded-xl bg-red-50 dark:bg-red-900/20 p-4 text-sm text-red-700 dark:text-red-300",children:r}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"mb-4 rounded-2xl bg-white dark:bg-surface-dark p-4 shadow",children:[(0,b.jsx)("div",{className:"text-sm text-slate-600 dark:text-slate-300",children:"Aluno"}),(0,b.jsx)("div",{className:"text-xl font-semibold",children:l?.name}),(0,b.jsxs)("div",{className:"mt-1 text-sm text-slate-600 dark:text-slate-300",children:[(0,b.jsx)("span",{className:"font-medium",children:"Ritmo P1k:"})," ",l?.p1k_pace??"—"]}),(0,b.jsx)("div",{className:"mt-3",children:(0,b.jsx)("button",{className:"text-sm underline text-slate-600 dark:text-slate-300",onClick:async()=>{await i.auth.signOut(),a.replace("/login")},children:"Sair"})})]}),0===t.length?(0,b.jsx)("div",{className:"text-sm text-slate-600 dark:text-slate-300",children:"Nenhum treino disponível."}):(0,b.jsx)("div",{className:"space-y-4",children:t.map(c=>(0,b.jsxs)("section",{className:"rounded-2xl bg-white dark:bg-surface-dark p-4 shadow",children:[(0,b.jsx)("h3",{className:"font-semibold mb-3",children:c.label}),(0,b.jsx)("div",{className:"space-y-3",children:c.workouts.map(c=>{let d=p[c.id],e=d?.status==="completed",f=l?.public_slug&&c.share_slug?`/w/${l.public_slug}/${c.share_slug}`:null;return(0,b.jsxs)("div",{className:"rounded-xl border border-slate-200 dark:border-slate-700 p-3 flex items-start justify-between gap-3",children:[(0,b.jsxs)("div",{className:"min-w-0",children:[(0,b.jsxs)("div",{className:"text-sm text-slate-600 dark:text-slate-300",children:[c.planned_date?h(c.planned_date):"Sem data"," ·"," ",g[c.template_type]??c.template_type," · ",c.total_km," km"]}),(0,b.jsx)("div",{className:"font-medium truncate",children:c.title||g[c.template_type]||"Treino"}),e?(0,b.jsxs)("div",{className:"mt-1 text-xs text-green-700 dark:text-green-300",children:["Feito",d?.performed_at?` em ${h(d.performed_at)}`:"",d?.rpe?` \xb7 RPE ${d.rpe}`:""]}):d?.status==="in_progress"?(0,b.jsx)("div",{className:"mt-1 text-xs text-amber-700 dark:text-amber-300",children:"Em andamento"}):(0,b.jsx)("div",{className:"mt-1 text-xs text-slate-500 dark:text-slate-400",children:"Pendente"})]}),(0,b.jsx)("div",{className:"shrink-0",children:(0,b.jsx)("button",{className:"px-3 py-2 rounded-lg bg-primary text-slate-900 font-semibold text-sm disabled:opacity-50",disabled:!f,onClick:()=>f&&a.push(f),children:"Abrir"})})]},c.id)})})]},c.key))})]})})]})}a.s(["default",()=>i])}];

//# sourceMappingURL=%5Broot-of-the-server%5D__ce57fb51._.js.map