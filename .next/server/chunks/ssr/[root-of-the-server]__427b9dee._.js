module.exports=[9270,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.AppRouterContext},36313,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.HooksClientContext},18341,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.ServerInsertedHtml},18622,(a,b,c)=>{b.exports=a.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},20635,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/action-async-storage.external.js",()=>require("next/dist/server/app-render/action-async-storage.external.js"))},32319,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},42602,(a,b,c)=>{"use strict";b.exports=a.r(18622)},87924,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactJsxRuntime},72131,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].React},81361,a=>{"use strict";var b=a.i(87924);let c=({title:a="PaceLink",showBack:c=!1,onBack:d,rightSlot:e,action:f,className:g=""})=>(0,b.jsx)("div",{className:`w-full bg-[#d1d1d1] ${g}`,children:(0,b.jsxs)("div",{className:"mx-auto max-w-2xl flex items-center justify-between px-4 py-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 min-w-0",children:[c?(0,b.jsx)("button",{type:"button",onClick:d,"aria-label":"Voltar",className:"text-white/90 hover:text-white",children:(0,b.jsx)("span",{className:"text-2xl leading-none",children:"‹"})}):null,(0,b.jsx)("div",{className:"text-white text-xl font-semibold truncate",children:a})]}),(0,b.jsx)("div",{className:"flex items-center gap-2",children:e??f??null})]})});a.s(["Topbar",0,c,"default",0,c])},34136,a=>{"use strict";var b=a.i(87924);let c=({children:a,variant:c="primary",size:d="lg",icon:e,fullWidth:f=!0,className:g="",...h})=>(0,b.jsxs)("button",{className:`flex items-center justify-center gap-2 rounded-full font-bold transition-all active:scale-[0.98] ${{primary:"bg-primary text-background-dark shadow-lg shadow-primary/25 hover:bg-[#25c464]",secondary:"bg-white dark:bg-surface-dark border border-slate-200 dark:border-white/10 text-slate-900 dark:text-white",ghost:"bg-transparent text-slate-600 dark:text-slate-400 hover:bg-black/5 dark:hover:bg-white/5",danger:"bg-red-500 text-white shadow-lg shadow-red-500/20"}[c]} ${{sm:"h-9 px-4 text-xs",md:"h-11 px-6 text-sm",lg:"h-14 px-8 text-lg",xl:"h-16 px-10 text-xl"}[d]} ${f?"w-full":""} ${g}`,...h,children:[e&&(0,b.jsx)("span",{className:"material-symbols-outlined",children:e}),a]});a.s(["Button",0,c,"default",0,c])},96916,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(19818),f=a.i(81361),g=a.i(34136);let h={easy_run:"Rodagem",progressive:"Progressivo",alternated:"Alternado"};function i(){return Math.random().toString(16).slice(2)}function j(a,b){let c=Number((a||"").replace(",","."));return Number.isFinite(c)?Math.max(b,c):b}function k({children:a}){return(0,b.jsx)("div",{className:"rounded-2xl border border-white/10 bg-white/5 p-4",children:a})}function l(){let a=(0,d.useRouter)(),l=(0,d.useParams)().id,m=(0,c.useMemo)(()=>(0,e.createClient)(),[]),[n,o]=(0,c.useState)(!0),[p,q]=(0,c.useState)(!1),[r,s]=(0,c.useState)(null),[t,u]=(0,c.useState)(null),[v,w]=(0,c.useState)(null),[x,y]=(0,c.useState)(null),[z,A]=(0,c.useState)(""),[B,C]=(0,c.useState)(""),[D,E]=(0,c.useState)(!1),[F,G]=(0,c.useState)("easy_run"),[H,I]=(0,c.useState)(!0),[J,K]=(0,c.useState)("2"),[L,M]=(0,c.useState)(!0),[N,O]=(0,c.useState)("1"),[P,Q]=(0,c.useState)([]);function R(){return H?j(J,.5):1}function S(){return L?j(N,.5):1}function T(){return P.map((a,b)=>({index:b+1,distance_km:j(a.distanceKm,.5),intensity:a.intensity}))}function U(){let a=H?R():0,b=L?S():0;return Math.round((a+T().reduce((a,b)=>a+(b.distance_km||0),0)+b)*10)/10}function V(a,b){Q(c=>c.map(c=>c.id===a?{...c,...b}:c))}async function W(){if(x){if(q(!0),s(null),D){s("Este treino já foi iniciado pelo aluno e não pode mais ser editado."),q(!1);return}try{let b={status:x.status,planned_date:B||null,template_type:F,title:z.trim()||null,include_warmup:H,warmup_km:R(),include_cooldown:L,cooldown_km:S(),blocks:T(),total_km:U()},{error:c}=await m.from("workouts").update(b).eq("id",x.id);if(c)throw c;s("Salvo!"),a.refresh()}catch(a){s(a?.message?`Erro: ${a.message}`:"Erro ao salvar.")}finally{q(!1)}}}async function X(){var a,b;let c,d;if(!x||!t)return;s(null);let{data:e,error:f}=await m.from("workouts").update({status:"ready"}).eq("id",x.id).select("id,share_slug").maybeSingle();if(f)return void s(f.message);let g=e?.share_slug;if(!g)return void s("share_slug vazio (trigger não gerou).");let h=t.public_slug||(a=t.name,b=t.id,c=(a||"").normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().trim().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)+/g,"")||"aluno",d=(b||"").replace(/-/g,"").slice(0,6)||"000000",`${c}-${d}`),i=`${window.location.origin}/w/${h}/${g}`;try{await navigator.clipboard.writeText(i),s("Link copiado!")}catch{s(`Link: ${i}`)}}return(0,c.useEffect)(()=>{let b=!0;return async function(){o(!0),s(null);let{data:{user:c}}=await m.auth.getUser();if(!c){let b=window.location.pathname+window.location.search;a.replace(`/login?next=${encodeURIComponent(b)}`);return}let{data:d,error:e}=await m.from("workouts").select("id,student_id,trainer_id,status,template_type,title,planned_date,locked_at,version,created_at,include_warmup,warmup_km,include_cooldown,cooldown_km,blocks,total_km,share_slug").eq("id",l).maybeSingle();if(!b)return;if(e){s(e.message),o(!1);return}if(!d){s("Treino não encontrado (ou sem permissão)."),o(!1);return}if(y(d),d?.week_id){let{data:a}=await m.from("weeks").select("id, week_start, week_end, label").eq("id",d.week_id).maybeSingle();w(a||null)}else w(null);A(d.title??""),C(d.planned_date??""),G(d.template_type??"easy_run"),I(!!d.include_warmup),K(String(d.warmup_km??"2")),M(!!d.include_cooldown),O(String(d.cooldown_km??"1"));let f=(Array.isArray(d.blocks)?d.blocks:[]).map(a=>({id:i(),distanceKm:String(a.distance_km??a.distanceKm??a.km??"1"),intensity:a.intensity??"moderado"}));Q(f.length?f:[{id:i(),distanceKm:"6",intensity:"leve"}]);let{data:g,error:h}=await m.from("students").select("id,name,public_slug").eq("id",d.student_id).maybeSingle();if(h){s(h.message),o(!1);return}u(g);let{count:j}=await m.from("executions").select("id",{count:"exact",head:!0}).eq("workout_id",l);E(!!d.locked_at||(j??0)>0),o(!1)}(),()=>{b=!1}},[a,m,l]),(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(f.default,{title:"Editar treino"}),(0,b.jsxs)("main",{className:"flex-1 p-4",children:[n?(0,b.jsx)("div",{className:"text-sm text-slate-600 dark:text-slate-300",children:"Carregando…"}):r?(0,b.jsx)("div",{className:"rounded-xl bg-amber-50 dark:bg-amber-900/20 p-4 text-sm text-amber-800 dark:text-amber-200",children:r}):null,x&&t?(0,b.jsxs)("div",{className:"mx-auto max-w-3xl space-y-4",children:[(0,b.jsxs)(k,{children:[(0,b.jsx)("div",{className:"text-white/70 text-sm",children:"Aluno"}),(0,b.jsx)("div",{className:"text-white text-xl font-semibold",children:t.name}),(0,b.jsxs)("div",{className:"mt-3 text-sm text-white/70",children:["Template: ",(0,b.jsx)("span",{className:"font-semibold text-white",children:h[x.template_type]??x.template_type})]}),(0,b.jsxs)("div",{className:"mt-1 text-sm text-white/70",children:["Semana planejada:"," ",(0,b.jsx)("span",{className:"font-semibold text-white",children:v?v.label||`${new Date(v.week_start).toLocaleDateString("pt-BR")} – ${new Date(v.week_end).toLocaleDateString("pt-BR")}`:"—"})]}),(0,b.jsxs)("div",{className:"mt-1 text-sm text-white/70",children:["Distância total estimada: ",(0,b.jsxs)("span",{className:"font-semibold text-white",children:[U()," km"]})]}),D?(0,b.jsxs)("div",{className:"mt-3 rounded-xl border border-amber-400/30 bg-amber-500/10 p-3 text-sm text-amber-200",children:["Este treino já foi iniciado pelo aluno e está ",(0,b.jsx)("span",{className:"font-semibold",children:"bloqueado para edição"}),"."]}):null]}),(0,b.jsxs)(k,{children:[(0,b.jsx)("div",{className:"font-semibold text-white",children:"Título"}),(0,b.jsx)("input",{className:"mt-3 w-full rounded-xl border border-white/10 bg-white/5 px-4 py-3 text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-[#2ef57f]/30 disabled:opacity-60",value:z,disabled:D,onChange:a=>A(a.target.value),placeholder:"Ex: Rodagem leve"})]}),(0,b.jsxs)(k,{children:[(0,b.jsx)("div",{className:"font-semibold text-white",children:"Data planejada (opcional)"}),(0,b.jsx)("input",{type:"date",className:"mt-3 w-full rounded-xl border border-white/10 bg-white/5 px-4 py-3 text-white focus:outline-none focus:ring-2 focus:ring-[#2ef57f]/30 disabled:opacity-60",value:B,onChange:a=>C(a.target.value),disabled:D})]}),(0,b.jsxs)(k,{children:[(0,b.jsx)("div",{className:"font-semibold text-white",children:"Template"}),(0,b.jsxs)("select",{className:"mt-3 w-full rounded-xl border border-white/10 bg-white/5 px-4 py-3 text-white focus:outline-none focus:ring-2 focus:ring-[#2ef57f]/30 disabled:opacity-60",value:F,disabled:D,onChange:a=>G(a.target.value),children:[(0,b.jsx)("option",{value:"easy_run",children:"Rodagem"}),(0,b.jsx)("option",{value:"progressive",children:"Progressivo"}),(0,b.jsx)("option",{value:"alternated",children:"Alternado"})]})]}),(0,b.jsxs)(k,{children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("div",{className:"font-semibold text-white",children:"Aquecimento"}),(0,b.jsxs)("label",{className:"inline-flex items-center gap-2 text-sm text-white/80",children:[(0,b.jsx)("input",{type:"checkbox",checked:H,onChange:()=>!D&&I(a=>!a)}),"Incluir"]})]}),(0,b.jsx)("input",{className:"mt-3 w-full rounded-xl border border-white/10 bg-white/5 px-4 py-3 text-white focus:outline-none focus:ring-2 focus:ring-[#2ef57f]/30 disabled:opacity-60",value:J,onChange:a=>K(a.target.value),disabled:!H||D,inputMode:"decimal"})]}),(0,b.jsxs)(k,{children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("div",{className:"font-semibold text-white",children:"Blocos"}),(0,b.jsx)("button",{className:"text-sm underline text-white/80",onClick:()=>!D&&void Q(a=>[...a,{id:i(),distanceKm:"1",intensity:"moderado"}]),children:"+ Adicionar bloco"})]}),(0,b.jsx)("div",{className:"mt-3 space-y-3",children:P.map((a,c)=>(0,b.jsxs)("div",{className:"rounded-xl border border-white/10 bg-white/5 p-3",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"text-white font-medium",children:["Bloco ",c+1]}),P.length>1?(0,b.jsx)("button",{className:"text-sm underline text-red-300",onClick:()=>{var b;return!D&&(b=a.id,void Q(a=>a.filter(a=>a.id!==b)))},children:"Remover"}):null]}),(0,b.jsxs)("div",{className:"mt-3 grid grid-cols-1 sm:grid-cols-2 gap-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm text-white/70",children:"Distância (km)"}),(0,b.jsx)("input",{className:"mt-2 w-full rounded-xl border border-white/10 bg-white/5 px-4 py-3 text-white focus:outline-none focus:ring-2 focus:ring-[#2ef57f]/30 disabled:opacity-60",value:a.distanceKm,onChange:b=>!D&&V(a.id,{distanceKm:b.target.value}),inputMode:"decimal",disabled:D})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm text-white/70",children:"Intensidade"}),(0,b.jsx)("div",{className:"mt-2 flex gap-2",children:["leve","moderado","forte"].map(c=>(0,b.jsx)("button",{type:"button",disabled:D,onClick:()=>!D&&V(a.id,{intensity:c}),className:`flex-1 px-3 py-2 rounded-lg text-sm font-semibold whitespace-nowrap disabled:opacity-60 ${a.intensity===c?"bg-[#2ef57f] text-slate-900":"bg-white/10 text-white"}`,children:"leve"===c?"Leve":"moderado"===c?"Moderado":"Forte"},c))})]})]})]},a.id))})]}),(0,b.jsxs)(k,{children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("div",{className:"font-semibold text-white",children:"Desaquecimento"}),(0,b.jsxs)("label",{className:"inline-flex items-center gap-2 text-sm text-white/80",children:[(0,b.jsx)("input",{type:"checkbox",checked:L,onChange:()=>!D&&M(a=>!a)}),"Incluir"]})]}),(0,b.jsx)("input",{className:"mt-3 w-full rounded-xl border border-white/10 bg-white/5 px-4 py-3 text-white focus:outline-none focus:ring-2 focus:ring-[#2ef57f]/30 disabled:opacity-60",value:N,onChange:a=>O(a.target.value),disabled:!L||D,inputMode:"decimal"})]}),(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2",children:[(0,b.jsx)(g.default,{onClick:W,disabled:p||D,fullWidth:!0,children:"Salvar alterações"}),(0,b.jsx)(g.default,{onClick:X,disabled:p,fullWidth:!0,children:"Copiar link do aluno"})]}),(0,b.jsx)("button",{className:"text-sm underline text-slate-600 dark:text-slate-300",onClick:()=>a.push(`/students/${x.student_id}`),children:"Voltar para o aluno"})]}):null]})]})}a.s(["default",()=>l])}];

//# sourceMappingURL=%5Broot-of-the-server%5D__427b9dee._.js.map