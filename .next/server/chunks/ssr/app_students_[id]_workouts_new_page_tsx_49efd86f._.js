module.exports=[50181,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(19818),f=a.i(81361),g=a.i(34136),h=a.i(19314);function i(a,b,c){return Number.isNaN(a)?b:Math.min(c,Math.max(b,a))}function j(a){let b=String(a.getDate()).padStart(2,"0"),c=String(a.getMonth()+1).padStart(2,"0");return`${b}/${c}`}function k(a){let b=Math.max(0,Math.round(a)),c=Math.floor(b/60),d=String(b%60).padStart(2,"0");return`${c}:${d}`}function l(a,b){let[c,d]={leve:[90,150],moderado:[45,90],forte:[15,45]}[b];return{min:a+c,max:a+d}}function m(){return Math.random().toString(36).slice(2,10)}function n(){let a=(0,d.useRouter)(),n=(0,d.useParams)(),o=n?.id||"",p=(0,c.useMemo)(()=>(0,e.createClient)(),[]),[q,r]=(0,c.useState)(null),[s,t]=(0,c.useState)("rodagem"),[u,v]=(0,c.useState)(!0),[w,x]=(0,c.useState)(2),[y,z]=(0,c.useState)(!1),[A,B]=(0,c.useState)(1),[C,D]=(0,c.useState)(5),[E,F]=(0,c.useState)("moderado"),[G,H]=(0,c.useState)([{id:m(),distanceKm:5,intensity:"moderado"}]),[I,J]=(0,c.useState)(6),[K,L]=(0,c.useState)(.2),[M,N]=(0,c.useState)(.2),[O,P]=(0,c.useState)(null),[Q,R]=(0,c.useState)(null),[S,T]=(0,c.useState)(!1),[U,V]=(0,c.useState)(null);(0,c.useEffect)(()=>{let a=!0;return async function(){if(V(null),!o)return;let{data:b,error:c}=await p.from("students").select("id,name,email,p1k_sec_per_km").eq("id",o).single();if(a){if(c)return V(c.message);r(b)}}(),()=>{a=!1}},[o,p]),(0,c.useEffect)(()=>{"progressivo"===s&&0===G.length&&H([{id:m(),distanceKm:5,intensity:"moderado"}])},[s,G.length]);let W=q?.p1k_sec_per_km??null,X=(0,c.useMemo)(()=>{let a=[],b=new Date,c=b=>{a.push({...b,index:a.length})};u&&c({segment_type:"warmup",label:"Aquecimento",distance_km:i(w,.1,50),intensity:"livre",hint_text:"Ritmo confortável para preparar o corpo."});let d="easy_run",e={};if("rodagem"===s){d="easy_run",e={main_distance_km:i(C,.1,200),intensity:E};let a=W?l(W,E):null;c({segment_type:"main",label:"Trecho principal",distance_km:i(C,.1,200),intensity:E,pace_min_sec_per_km:a?.min??null,pace_max_sec_per_km:a?.max??null,hint_text:"leve"===E?"Leve e constante. Foque em respirar e manter técnica.":"Moderado e constante. Sustente sem “quebrar”."})}if("progressivo"===s&&(d="progressive",e={phases:G.map((a,b)=>({order:b+1,distance_km:i(a.distanceKm,.1,200),intensity:a.intensity}))},G.forEach((a,b)=>{let d=W?l(W,a.intensity):null;c({segment_type:"main",label:`Bloco ${b+1}`,distance_km:i(a.distanceKm,.1,200),intensity:a.intensity,pace_min_sec_per_km:d?.min??null,pace_max_sec_per_km:d?.max??null,hint_text:"leve"===a.intensity?"Comece controlado, foco em eficiência.":"moderado"===a.intensity?"Aumente gradualmente mantendo controle.":"Feche forte sem perder a técnica."})})),"alternado"===s){d="alternated",e={repeats:i(I,1,60),strong_distance_km:i(K,.05,10),easy_distance_km:i(M,.05,10)};let a=i(I,1,60);for(let b=1;b<=a;b++){let a=W?l(W,"forte"):null;c({segment_type:"main",label:`Tiro ${b}`,distance_km:i(K,.05,10),intensity:"forte",pace_min_sec_per_km:a?.min??null,pace_max_sec_per_km:a?.max??null,hint_text:"Forte. Foque em postura e cadência."}),c({segment_type:"main",label:`Recupera\xe7\xe3o ${b}`,distance_km:i(M,.05,10),intensity:"leve",pace_min_sec_per_km:null,pace_max_sec_per_km:null,hint_text:"Solte e recupere. Respiração e técnica."})}}y&&c({segment_type:"cooldown",label:"Desaquecimento",distance_km:i(A,.1,50),intensity:"livre",hint_text:"Reduza o ritmo gradualmente para recuperar."});let f=a.reduce((a,b)=>a+(Number(b.distance_km)||0),0),g="rodagem"===s?"Rodagem":"progressivo"===s?"Progressivo":"Alternado";return{blocks:a,total_km:Math.round(10*f)/10,template_type:d,template_params:e,share_title:`${g} • ${j(b)}`}},[u,w,y,A,s,C,E,G,I,K,M,W]);async function Y(){let{data:b}=await p.auth.getUser();if(!b.user)throw a.push("/login"),Error("Sessão expirada. Faça login novamente.");return b.user}async function Z(a){T(!0),V(null);try{let b,c,d=await Y(),e="ready"===a?Q||(b=(X.share_title||"treino").trim().toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)+/g,"").slice(0,60),c=Math.random().toString(36).slice(2,6),`${b}-${c}`):null,f={trainer_id:d.id,student_id:o,status:a,template_type:X.template_type,include_warmup:u,warmup_km:u?w:null,include_cooldown:y,cooldown_km:y?A:null,template_params:X.template_params,blocks:X.blocks,total_km:X.total_km,share_slug:e},g=null;if(O){let{data:a,error:b}=await p.from("workouts").update(f).eq("id",O).select("id,share_slug").single();if(b)throw b;g=a}else{let{data:a,error:b}=await p.from("workouts").insert(f).select("id,share_slug").single();if(b)throw b;g=a,P(g.id)}return R(g?.share_slug??e),g?.share_slug??e}finally{T(!1)}}async function $(){try{await Z("draft"),alert("Rascunho salvo com sucesso.")}catch(a){V(a?.message||"Erro ao salvar rascunho.")}}async function _(a,b){if("u">typeof navigator&&navigator.share)try{await navigator.share({title:"PaceLink",text:a,url:b});return}catch{}try{await navigator.clipboard.writeText(a),alert("Link copiado para a área de transferência.")}catch{prompt("Copie o link abaixo:",b)}}async function aa(){try{let a=await Z("ready");if(!a)throw Error("Não foi possível gerar o link compartilhável.");let b=`${window.location.origin}/w/${a}`,c=`Treino do dia (${j(new Date)})
Aluno: ${q?.name||"—"}

Abra o link e toque em “Iniciar execu\xe7\xe3o”:
${b}

Qualquer d\xfavida, me chama.`;await _(c,b),window.open(b,"_blank","noopener,noreferrer")}catch(a){V(a?.message||"Erro ao compartilhar treino.")}}let ab=a=>`px-4 py-2 rounded-full text-sm font-semibold transition ${a?"bg-primary text-slate-900":"bg-surface-dark text-slate-200 hover:bg-surface-dark/80"}`,ac=a=>`flex-1 py-2 rounded-full text-sm font-semibold transition ${a?"bg-primary text-slate-900":"bg-surface-dark text-slate-300 hover:bg-surface-dark/80"}`,ad=a=>`flex-1 py-2 rounded-full text-sm font-semibold transition ${a?"bg-primary text-slate-900":"bg-surface-dark text-slate-300 hover:bg-surface-dark/80"}`;return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(f.Topbar,{title:"Criar Treino",backHref:`/students/${o}`}),(0,b.jsxs)("main",{className:"flex-1 flex flex-col p-6 gap-5",children:[U&&(0,b.jsx)("div",{className:"rounded-lg bg-red-50 dark:bg-red-900/20 p-4 text-sm text-red-700 dark:text-red-300",children:U}),(0,b.jsxs)("section",{children:[(0,b.jsx)("h2",{className:"text-lg font-semibold mb-3",children:"Tipo de Treino"}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)("button",{type:"button",className:ab("rodagem"===s),onClick:()=>t("rodagem"),children:[(0,b.jsx)("span",{className:"material-symbols-outlined align-middle mr-2",children:"directions_run"}),"Rodagem"]}),(0,b.jsx)("button",{type:"button",className:ab("progressivo"===s),onClick:()=>t("progressivo"),children:"Progressivo"}),(0,b.jsx)("button",{type:"button",className:ab("alternado"===s),onClick:()=>t("alternado"),children:"Alternado"})]})]}),(0,b.jsxs)("section",{children:[(0,b.jsx)("h2",{className:"text-lg font-semibold mb-3",children:"Estrutura"}),(0,b.jsxs)(h.Card,{children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:"material-symbols-outlined text-primary",children:"local_fire_department"}),(0,b.jsx)("span",{className:"font-semibold",children:"Aquecimento"})]}),(0,b.jsx)("button",{type:"button",onClick:()=>v(a=>!a),className:`w-14 h-8 rounded-full p-1 transition ${u?"bg-primary/90":"bg-surface-dark"}`,"aria-label":"Ativar aquecimento",children:(0,b.jsx)("span",{className:`block w-6 h-6 rounded-full bg-white transition ${u?"translate-x-6":"translate-x-0"}`})})]}),u&&(0,b.jsxs)("div",{className:"mt-4 grid grid-cols-2 gap-3",children:[(0,b.jsxs)("div",{className:"rounded-xl bg-surface-dark/60 p-3",children:[(0,b.jsx)("div",{className:"text-xs uppercase tracking-wide text-slate-400",children:"Distância"}),(0,b.jsxs)("div",{className:"mt-1 flex items-baseline gap-2",children:[(0,b.jsx)("input",{type:"number",step:"0.1",value:w,onChange:a=>x(Number(a.target.value)),className:"w-20 bg-transparent text-2xl font-bold outline-none"}),(0,b.jsx)("span",{className:"text-slate-400",children:"km"})]})]}),(0,b.jsxs)("div",{className:"rounded-xl bg-surface-dark/60 p-3",children:[(0,b.jsx)("div",{className:"text-xs uppercase tracking-wide text-slate-400",children:"Ritmo"}),(0,b.jsx)("div",{className:"mt-2 text-lg font-semibold",children:"Livre"})]})]})]}),(0,b.jsxs)("div",{className:"mt-5",children:[(0,b.jsx)("div",{className:"text-xs uppercase tracking-wide text-slate-400 mb-2",children:"Blocos principais"}),"rodagem"===s&&(0,b.jsxs)(h.Card,{children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,b.jsxs)("div",{className:"rounded-xl bg-surface-dark/60 p-3",children:[(0,b.jsx)("div",{className:"text-xs uppercase tracking-wide text-slate-400",children:"Distância do trecho"}),(0,b.jsxs)("div",{className:"mt-1 flex items-baseline gap-2",children:[(0,b.jsx)("input",{type:"number",step:"0.1",value:C,onChange:a=>D(Number(a.target.value)),className:"w-24 bg-transparent text-2xl font-bold outline-none"}),(0,b.jsx)("span",{className:"text-slate-400",children:"km"})]})]}),(0,b.jsxs)("div",{className:"rounded-xl bg-surface-dark/60 p-3",children:[(0,b.jsx)("div",{className:"text-xs uppercase tracking-wide text-slate-400",children:"Intensidade"}),(0,b.jsxs)("div",{className:"mt-2 flex gap-2",children:[(0,b.jsx)("button",{type:"button",className:ad("leve"===E),onClick:()=>F("leve"),children:"Leve"}),(0,b.jsx)("button",{type:"button",className:ad("moderado"===E),onClick:()=>F("moderado"),children:"Moderado"})]})]})]}),W&&(0,b.jsxs)("div",{className:"mt-3 text-sm text-slate-300",children:["Alvo estimado (base P1K):"," ",(0,b.jsxs)("span",{className:"font-semibold text-primary",children:[k(l(W,E).min),"–",k(l(W,E).max)," min/km"]})]})]}),"progressivo"===s&&(0,b.jsxs)(b.Fragment,{children:[G.map((a,c)=>(0,b.jsxs)(h.Card,{className:"mb-3",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,b.jsxs)("div",{className:"flex-1 grid grid-cols-2 gap-3",children:[(0,b.jsxs)("div",{className:"rounded-xl bg-surface-dark/60 p-3",children:[(0,b.jsxs)("div",{className:"text-xs uppercase tracking-wide text-slate-400",children:["Distância (Bloco ",c+1,")"]}),(0,b.jsxs)("div",{className:"mt-1 flex items-baseline gap-2",children:[(0,b.jsx)("input",{type:"number",step:"0.1",value:a.distanceKm,onChange:b=>{let c=Number(b.target.value);H(b=>b.map(b=>b.id===a.id?{...b,distanceKm:c}:b))},className:"w-24 bg-transparent text-2xl font-bold outline-none"}),(0,b.jsx)("span",{className:"text-slate-400",children:"km"})]})]}),(0,b.jsxs)("div",{className:"rounded-xl bg-surface-dark/60 p-3",children:[(0,b.jsx)("div",{className:"text-xs uppercase tracking-wide text-slate-400",children:"Intensidade"}),(0,b.jsxs)("div",{className:"mt-2 flex gap-2",children:[(0,b.jsx)("button",{type:"button",className:ac("leve"===a.intensity),onClick:()=>H(b=>b.map(b=>b.id===a.id?{...b,intensity:"leve"}:b)),children:"Leve"}),(0,b.jsx)("button",{type:"button",className:ac("moderado"===a.intensity),onClick:()=>H(b=>b.map(b=>b.id===a.id?{...b,intensity:"moderado"}:b)),children:"Moderado"}),(0,b.jsx)("button",{type:"button",className:ac("forte"===a.intensity),onClick:()=>H(b=>b.map(b=>b.id===a.id?{...b,intensity:"forte"}:b)),children:"Forte"})]})]})]}),(0,b.jsx)("button",{type:"button",title:"Remover bloco",onClick:()=>{H(b=>b.length<=1?b:b.filter(b=>b.id!==a.id))},className:"mt-2 text-slate-300 hover:text-red-300 transition",children:(0,b.jsx)("span",{className:"material-symbols-outlined",children:"delete"})})]}),W&&(0,b.jsxs)("div",{className:"mt-3 text-sm text-slate-300",children:["Alvo estimado:"," ",(0,b.jsxs)("span",{className:"font-semibold text-primary",children:[k(l(W,a.intensity).min),"–",k(l(W,a.intensity).max)," min/km"]})]})]},a.id)),(0,b.jsxs)("button",{type:"button",className:"w-full border border-dashed border-slate-600 rounded-2xl py-4 text-slate-200 hover:border-slate-500 hover:bg-surface-dark/30 transition",onClick:()=>H(a=>[...a,{id:m(),distanceKm:1,intensity:"moderado"}]),children:[(0,b.jsx)("span",{className:"material-symbols-outlined align-middle mr-2",children:"add"}),"Adicionar Bloco"]})]}),"alternado"===s&&(0,b.jsx)(h.Card,{children:(0,b.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[(0,b.jsxs)("div",{className:"rounded-xl bg-surface-dark/60 p-3",children:[(0,b.jsx)("div",{className:"text-xs uppercase tracking-wide text-slate-400",children:"Repetições"}),(0,b.jsxs)("div",{className:"mt-1 flex items-baseline gap-2",children:[(0,b.jsx)("input",{type:"number",step:"1",value:I,onChange:a=>J(Number(a.target.value)),className:"w-20 bg-transparent text-2xl font-bold outline-none"}),(0,b.jsx)("span",{className:"text-slate-400",children:"x"})]})]}),(0,b.jsxs)("div",{className:"rounded-xl bg-surface-dark/60 p-3",children:[(0,b.jsx)("div",{className:"text-xs uppercase tracking-wide text-slate-400",children:"Tiro (Forte)"}),(0,b.jsxs)("div",{className:"mt-1 flex items-baseline gap-2",children:[(0,b.jsx)("input",{type:"number",step:"0.05",value:K,onChange:a=>L(Number(a.target.value)),className:"w-20 bg-transparent text-2xl font-bold outline-none"}),(0,b.jsx)("span",{className:"text-slate-400",children:"km"})]})]}),(0,b.jsxs)("div",{className:"rounded-xl bg-surface-dark/60 p-3",children:[(0,b.jsx)("div",{className:"text-xs uppercase tracking-wide text-slate-400",children:"Recuperação (Leve)"}),(0,b.jsxs)("div",{className:"mt-1 flex items-baseline gap-2",children:[(0,b.jsx)("input",{type:"number",step:"0.05",value:M,onChange:a=>N(Number(a.target.value)),className:"w-20 bg-transparent text-2xl font-bold outline-none"}),(0,b.jsx)("span",{className:"text-slate-400",children:"km"})]})]})]})})]}),(0,b.jsx)("div",{className:"mt-5",children:(0,b.jsxs)(h.Card,{children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:"material-symbols-outlined text-primary",children:"ac_unit"}),(0,b.jsx)("span",{className:"font-semibold",children:"Desaquecimento"})]}),(0,b.jsx)("button",{type:"button",onClick:()=>z(a=>!a),className:`w-14 h-8 rounded-full p-1 transition ${y?"bg-primary/90":"bg-surface-dark"}`,"aria-label":"Ativar desaquecimento",children:(0,b.jsx)("span",{className:`block w-6 h-6 rounded-full bg-white transition ${y?"translate-x-6":"translate-x-0"}`})})]}),y&&(0,b.jsxs)("div",{className:"mt-4 grid grid-cols-2 gap-3",children:[(0,b.jsxs)("div",{className:"rounded-xl bg-surface-dark/60 p-3",children:[(0,b.jsx)("div",{className:"text-xs uppercase tracking-wide text-slate-400",children:"Distância"}),(0,b.jsxs)("div",{className:"mt-1 flex items-baseline gap-2",children:[(0,b.jsx)("input",{type:"number",step:"0.1",value:A,onChange:a=>B(Number(a.target.value)),className:"w-20 bg-transparent text-2xl font-bold outline-none"}),(0,b.jsx)("span",{className:"text-slate-400",children:"km"})]})]}),(0,b.jsxs)("div",{className:"rounded-xl bg-surface-dark/60 p-3",children:[(0,b.jsx)("div",{className:"text-xs uppercase tracking-wide text-slate-400",children:"Ritmo"}),(0,b.jsx)("div",{className:"mt-2 text-lg font-semibold",children:"Livre"})]})]})]})}),(0,b.jsxs)("div",{className:"mt-5 text-sm text-slate-300",children:["Distância total estimada:"," ",(0,b.jsxs)("span",{className:"font-semibold text-primary",children:[X.total_km," km"]})]})]}),(0,b.jsxs)("div",{className:"mt-auto flex gap-3 pt-3",children:[(0,b.jsx)(g.Button,{variant:"secondary",fullWidth:!0,onClick:$,disabled:S,children:S?"Salvando...":"Salvar rascunho"}),(0,b.jsxs)(g.Button,{fullWidth:!0,onClick:aa,disabled:S,children:[(0,b.jsx)("span",{className:"material-symbols-outlined align-middle mr-2",children:"share"}),"Compartilhar"]})]})]})]})}a.s(["default",()=>n])}];

//# sourceMappingURL=app_students_%5Bid%5D_workouts_new_page_tsx_49efd86f._.js.map